<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>龍昌博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="关注Linux及开源信息">
<meta property="og:type" content="website">
<meta property="og:title" content="龍昌博客">
<meta property="og:url" content="http://www.xefan.com/page/3/index.html">
<meta property="og:site_name" content="龍昌博客">
<meta property="og:description" content="关注Linux及开源信息">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="龍昌博客">
<meta name="twitter:description" content="关注Linux及开源信息">
  
    <link rel="alternate" href="/atom.xml" title="龍昌博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">龍昌博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">从Pythoneer转向Rubist</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
          <a class="main-nav-link" href="/gbook">留言板</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.xefan.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-/archives/84152.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84152.html" class="article-date">
  <time datetime="2015-08-21T09:55:14.000Z" itemprop="datePublished">2015-08-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端相关/">前端相关</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84152.html">Riot.js之初体验</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Riot(<a href="http://riotjs.com/)按照官方的介绍，它是一个类似于" target="_blank" rel="external">http://riotjs.com/)按照官方的介绍，它是一个类似于</a> React 的微型框架。<br>压缩之后的文件只有差不多 15K 的大小，相比其他基本上都是上百K大小的框架来说确实是很微型的。</p>
<p>同时它的官方还给出了与 React 和 Polymer 的对比，各位感兴趣可以看看： <a href="http://riotjs.com/compare/" target="_blank" rel="external">http://riotjs.com/compare/</a></p>
<p>下面通过一个例子来体验一下。</p>
<p>先下载 Riot 库文件： <a href="https://raw.githubusercontent.com/riot/riot/master/riot+compiler.min.js" target="_blank" rel="external">https://raw.githubusercontent.com/riot/riot/master/riot+compiler.min.js</a><br>然后新建一个文件 <code>index.html</code>，内容如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Tabs exampe<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">media</span>=<span class="string">"screen"</span>&gt;</span><span class="undefined"></span></div><div class="line">      .tabContent__item&#123;</div><div class="line">        display:none;</div><div class="line">      &#125;</div><div class="line">      .tabContent__item.is-active&#123;</div><div class="line">        display:block;</div><div class="line">      &#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">riot-tabs</span>&gt;</span><span class="tag">&lt;/<span class="name">riot-tabs</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"tabs.tag"</span> <span class="attr">type</span>=<span class="string">"riot/tag"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"riot+compiler.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span></div><div class="line">      riot.mount('riot-tabs');</div><div class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>接着再创建文件 <code>tabs.tag</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;riot-tabs&gt;</div><div class="line">  &lt;h2&gt;Tabs&lt;/h2&gt;</div><div class="line">  &lt;ul&gt;</div><div class="line">    &lt;li each=&#123; tab, i in tabs &#125; class=&quot;tabItem &#123; is-active: parent.isActiveTab(tab.ref) &#125;&quot; onclick=&#123; parent.toggleTab &#125;&gt;&#123;tab.title&#125;&lt;/li&gt;</div><div class="line">  &lt;/ul&gt;</div><div class="line">  &lt;div class=&quot;tabContent&quot;&gt;</div><div class="line">    &lt;div each=&#123; tab, i in tabs &#125; class=&quot;tabContent__item &#123; is-active: parent.isActiveTab(tab.ref) &#125;&quot;&gt;&#123;tab.content&#125;&lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line"></div><div class="line">  this.tabs = [</div><div class="line">    &#123; title: &apos;Tab 1&apos;, ref: &apos;tab1&apos;, content: &quot;(1) Lorem ipsum dolor&quot; &#125;,</div><div class="line">    &#123; title: &apos;Tab 2&apos;, ref: &apos;tab2&apos;, content: &quot;(2) Lorem ipsum dolor&quot; &#125;,</div><div class="line">    &#123; title: &apos;Tab 3&apos;, ref: &apos;tab3&apos;, content: &quot;(3) Lorem ipsum dolor&quot; &#125;</div><div class="line">  ]</div><div class="line"></div><div class="line">  this.activeTab = &apos;tab1&apos;</div><div class="line"></div><div class="line">  isActiveTab(tab) &#123;</div><div class="line">    return this.activeTab === tab</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  toggleTab(e) &#123;</div><div class="line">    this.activeTab = e.item.tab.ref</div><div class="line">    return true</div><div class="line">  &#125;</div><div class="line">&lt;/riot-tabs&gt;</div></pre></td></tr></table></figure>
<p>这个是 javascript 与 html 的混合。当然还可以使用纯 js 的写法，将 <code>tabs.tag</code> 改为 <code>tabs.js</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">riot.tag(&apos;riot-tabs&apos;, &apos;&lt;h2&gt;Tabs&lt;/h2&gt; &lt;ul&gt; &lt;li each=&quot;&#123; tab, i in tabs &#125;&quot; class=&quot;tabItem &#123; is-active: parent.isActiveTab(tab.ref) &#125;&quot; onclick=&quot;&#123; parent.toggleTab &#125;&quot;&gt;&#123;tab.title&#125;&lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;tabContent&quot;&gt; &lt;div each=&quot;&#123; tab, i in tabs &#125;&quot; class=&quot;tabContent__item &#123; is-active: parent.isActiveTab(tab.ref) &#125;&quot;&gt;&#123;tab.content&#125;&lt;/div&gt; &lt;/div&gt;&apos;, function(opts) &#123;</div><div class="line"></div><div class="line">  this.tabs = [</div><div class="line">    &#123; title: &apos;Tab 1&apos;, ref: &apos;tab1&apos;, content: &quot;(1) Lorem ipsum dolor&quot; &#125;,</div><div class="line">    &#123; title: &apos;Tab 2&apos;, ref: &apos;tab2&apos;, content: &quot;(2) Lorem ipsum dolor&quot; &#125;,</div><div class="line">    &#123; title: &apos;Tab 3&apos;, ref: &apos;tab3&apos;, content: &quot;(3) Lorem ipsum dolor&quot; &#125;</div><div class="line">  ];</div><div class="line"></div><div class="line">  this.activeTab = &apos;tab1&apos;;</div><div class="line"></div><div class="line">  this.isActiveTab = function(tab) &#123;</div><div class="line">    return this.activeTab === tab;</div><div class="line">  &#125;.bind(this);</div><div class="line"></div><div class="line">  this.toggleTab = function(e) &#123;</div><div class="line">    this.activeTab = e.item.tab.ref;</div><div class="line">    return true;</div><div class="line">  &#125;.bind(this);</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>同时将 <code>index.html</code> 中的 <code>&lt;script src=&quot;tabs.tag&quot; type=&quot;riot/tag&quot;&gt;&lt;/script&gt;</code> 修改为 <code>&lt;script src=&quot;tabs.js&quot; type=&quot;riot/tag&quot;&gt;&lt;/script&gt;</code> 。</p>
<p>好了，现在打开浏览器看下效果吧。</p>
<p>体验了一下，感觉它比 angular 之类的框架的学习成本要低。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84152.html" data-id="cjoslv00u00pksh08iq7ubch9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-/archives/84151.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84151.html" class="article-date">
  <time datetime="2015-08-20T20:58:53.000Z" itemprop="datePublished">2015-08-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端相关/">前端相关</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84151.html">AngularJS学习笔记5——路由</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>angularjs 的 <code>ngRoute</code> 模块提供了前端路由的功能。<br>在 angularjs 1.3 中 route 模块被单独提取了出来，要使用其功能需要将引用进来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;/lib/angular-1.3.15.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script src=&quot;/lib/angular-route-1.3.15.min.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">var routeApp = angular.module(&apos;routeApp&apos;, [&apos;ngRoute&apos;]);</div><div class="line">routeApp.config([&apos;$routeProvider&apos;,function ($routeProvider) &#123;</div><div class="line">    $routeProvider</div><div class="line">    .when(&apos;/list&apos;, &#123;</div><div class="line">      templateUrl: &apos;list.html&apos;,</div><div class="line">      controller: &apos;RouteListCtl&apos;</div><div class="line">    &#125;)</div><div class="line">    .when(&apos;/list/:id&apos;, &#123;</div><div class="line">        templateUrl: &apos;detail.html&apos;,</div><div class="line">        controller: &apos;RouteDetailCtl&apos;</div><div class="line">    &#125;)</div><div class="line">    .otherwise(&#123;</div><div class="line">      redirectTo: &apos;/list&apos;</div><div class="line">    &#125;);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<p>这里定义了两条路由规则，对应的视图模板分别为 list.html 和 detail.html</p>
<p>视图模板有三种定义方式：<br>方法1：编写在单独的文件中，然后 angularjs 通过 ajax 获取其内容；<br>方法2：直接在页面中使用 script 标签定义，如： <code>&lt;script type=&quot;text/ng-template&quot; id=&quot;list.html&quot;&gt; .... &lt;/script&gt;</code>；<br>方法3：使用 <code>$templateCache</code> 进行定义，如:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">routeApp.run(function($templateCache) &#123;</div><div class="line">  $templateCache.put(&apos;list.html&apos;, &apos;...&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84151.html" data-id="cjoslv00r00pfsh08f0cikunc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-/archives/84150.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84150.html" class="article-date">
  <time datetime="2015-08-19T13:33:33.000Z" itemprop="datePublished">2015-08-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端相关/">前端相关</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84150.html">AngularJS学习笔记4——依赖注入</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h2><p>之前有遇到过 angularjs 的代码压缩之后就报错了，通过查文档得知是因为 angularjs 是通过变量名来查找相应服务的。<br>而 js 代码压缩之后变量名就变化了，从而无法找到相应的服务而报错。因此就需要指明依赖服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">function SomeController($scope, $http) &#123; ... &#125;</div></pre></td></tr></table></figure>
<p>例如以上代码就是定义了 <code>SomeController</code> 这个一个控制器，并依赖 <code>$scope</code> 和 <code>$http</code> 两个服务。<br>但是当该代码压缩之后，这两个参数名都变化了。因此还需要使用以下代码来指明所需的依赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SomeController.$inject = [&apos;$scope&apos;, &apos;$http&apos;];</div></pre></td></tr></table></figure>
<p>或者另一个写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">angular.module(&apos;app&apos;, [])</div><div class="line">       .controller(&apos;SomeController&apos;, [&apos;$scope&apos;, &apos;$http&apos;, function($scope, $http)&#123;</div><div class="line"></div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<p>这样就可以保证我们的代码压缩之后也能正常运行了。</p>
<h2 id="自定义服务"><a href="#自定义服务" class="headerlink" title="自定义服务"></a>自定义服务</h2><p>上面的 <code>$http</code> 服务为我们提供了 ajax 的功能。</p>
<p>需要自定义服务的可以使用 <code>module.factory</code> 方法或者 <code>module.service</code> 方法进行注册服务。<br>这两个方法稍微有些不同，一般我习惯使用 <code>module.factory</code> 。<br>然后在需要使用自定义服务的地方，将其添加到依赖列表中即可。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84150.html" data-id="cjoslv00q00pcsh08tsi1upmn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-/archives/84149.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84149.html" class="article-date">
  <time datetime="2015-08-18T18:32:35.000Z" itemprop="datePublished">2015-08-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端相关/">前端相关</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84149.html">AngularJS学习笔记3——表单</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="双向绑定"><a href="#双向绑定" class="headerlink" title="双向绑定"></a>双向绑定</h2><p>使用 <code>ngModel</code> 指令将输入框与 model 进行绑定，如： <code>&lt;input type=&quot;text&quot; ng-model=&quot;text&quot; name=&quot;text&quot; /&gt;</code><br>当输入框或者 model 的值其中一方改变都会影响另一方。</p>
<h2 id="表单验证"><a href="#表单验证" class="headerlink" title="表单验证"></a>表单验证</h2><p>之前表单验证都是用的 jquery-validation 这个插件，这需要编写大量的 js 代码用于逻辑控制，<br>现在改用 angularjs 之后方便了许多，不过还是要编写大量的视图代码。</p>
<p>一个简单的例子： <a href="https://github.com/wusuopu/angularjs-practice/blob/master/static/form/validate.html" target="_blank" rel="external">https://github.com/wusuopu/angularjs-practice/blob/master/static/form/validate.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;#&quot; name=&quot;user_form&quot; ng-submit=&quot;submitForm(user_form.$valid, $event)&quot; novalidate&gt;</div><div class="line"></div><div class="line">    &lt;div class=&quot;form-group&quot; ng-class=&quot;&#123;&apos;has-error&apos; : user_form.name.$invalid &amp;&amp; user_form.name.$dirty, &apos;has-success&apos; : user_form.name.$valid&#125;&quot;&gt;</div><div class="line">        &lt;label&gt;Name&lt;/label&gt;</div><div class="line">        &lt;input type=&quot;text&quot; name=&quot;name&quot; class=&quot;form-control&quot; ng-model=&quot;formData.name&quot; required&gt;</div><div class="line">        &lt;p ng-show=&quot;user_form.name.$invalid &amp;&amp; user_form.name.$dirty&quot; class=&quot;help-block&quot;&gt;You name is required.&lt;/p&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">.....</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure>
<p>首先为 form 表单设置 <code>name</code> 属性，并设置 <code>novalidate</code> 属性禁止浏览器使用 HTML5 自带的验证功能。<br>然后对于需要验证的字段添加相应的验证属性，angularjs 内建的验证规则如下：</p>
<ul>
<li>email</li>
<li>max</li>
<li>maxlength</li>
<li>min</li>
<li>minlength</li>
<li>number</li>
<li>pattern</li>
<li>required</li>
<li>url</li>
<li>date</li>
<li>datetimelocal</li>
<li>time</li>
<li>week</li>
<li>month</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84149.html" data-id="cjoslv00n00p8sh08cmfqy1cl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-/archives/84148.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84148.html" class="article-date">
  <time datetime="2015-08-14T22:00:21.000Z" itemprop="datePublished">2015-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端相关/">前端相关</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84148.html">AngularJS学习笔记2——模板</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ngRepeat"><a href="#ngRepeat" class="headerlink" title="ngRepeat"></a>ngRepeat</h2><p>对于一些需要循环遍历的对象可以使用 <code>ngRepeat</code> 指令。 如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;li ng-repeat=&quot;msg in messages&quot;&gt;&#123;&#123;$index&#125;&#125; &#123;&#123;msg&#125;&#125;&lt;/li&gt;</div><div class="line"></div><div class="line">// 对于 messages 数组进行遍历</div><div class="line">$scope.messages =  [</div><div class="line">  &quot;第一条消息&quot;,</div><div class="line">  &quot;第二条消息&quot;,</div><div class="line">  &quot;第三条消息&quot;,</div><div class="line">  &quot;第四条消息&quot;,</div><div class="line">  &quot;第五条消息&quot;</div><div class="line">];</div></pre></td></tr></table></figure>
<h2 id="ngSwitch"><a href="#ngSwitch" class="headerlink" title="ngSwitch"></a>ngSwitch</h2><p>使用 <code>ngSwitch</code> 指令在不同条件下显示不同内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-controller=&quot;ExampleController&quot;&gt;</div><div class="line">  &lt;select ng-model=&quot;selection&quot; ng-options=&quot;item for item in items&quot;&gt;</div><div class="line">  &lt;/select&gt;</div><div class="line">  &lt;code&gt;selection=&#123;&#123;selection&#125;&#125;&lt;/code&gt;</div><div class="line">  &lt;hr/&gt;</div><div class="line">  &lt;div class=&quot;animate-switch-container&quot;</div><div class="line">    ng-switch=&quot;selection&quot;&gt;</div><div class="line">      &lt;div class=&quot;animate-switch&quot; ng-switch-when=&quot;settings&quot;&gt;Settings Div&lt;/div&gt;</div><div class="line">      &lt;div class=&quot;animate-switch&quot; ng-switch-when=&quot;home&quot;&gt;Home Span&lt;/div&gt;</div><div class="line">      &lt;div class=&quot;animate-switch&quot; ng-switch-default&gt;default&lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;script type=&quot;text/javascript&quot;&gt;</div><div class="line">angular.module(&apos;myApp&apos;, []).controller(&apos;ExampleController&apos;, [&apos;$scope&apos;, function($scope) &#123;</div><div class="line">  $scope.items = [&apos;settings&apos;, &apos;home&apos;, &apos;other&apos;];</div><div class="line">  $scope.selection = $scope.items[0];</div><div class="line">&#125;]);</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<h2 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h2><p>使用 <code>filter</code> 指令过滤需要的内容，基本形式： <code>{{ expression | filter }}</code><br>如果有用过其他模板引擎的话（如：Jinja）应该很好理解的。</p>
<p>angularjs 提供了一些内置的过滤器：date, json, lowercase, uppercase 等。</p>
<h2 id="ngIf"><a href="#ngIf" class="headerlink" title="ngIf"></a>ngIf</h2><p>基本形式： <code>&lt;ANY ng-if=&quot;expression&quot;&gt; ... &lt;/ANY&gt;</code><br>当 <code>expression</code> 的值为真时才会输出该标签。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84148.html" data-id="cjoslv00l00p4sh08uhtv057p" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-/archives/84147.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84147.html" class="article-date">
  <time datetime="2015-08-13T22:54:04.000Z" itemprop="datePublished">2015-08-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端相关/">前端相关</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84147.html">AngularJS学习笔记1——基础入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>angularjs 是一款前端的 MVVM 框架，目前 2.0 好像也快要发布了。<br>angularjs 2.0 的理念又变为了 Web 组件，与 1.x 不兼容。<br>于是这里就把之前 angularjs 1.x 的学习笔记整理一下，作为以后回顾吧。</p>
<p>相关的事例代码可以从 <a href="https://github.com/wusuopu/angularjs-practice" target="_blank" rel="external">https://github.com/wusuopu/angularjs-practice</a> 获取。</p>
<h2 id="简单事例"><a href="#简单事例" class="headerlink" title="简单事例"></a>简单事例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;!doctype html&gt;</div><div class="line">&lt;html lang=&quot;en&quot; ng-app&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</div><div class="line">    &lt;title&gt;基本例子&lt;/title&gt;</div><div class="line">    &lt;script src=&quot;/lib/angular-1.0.4.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">  &lt;p&gt;1 + 2 = &#123;&#123; 1 + 2 &#125;&#125;&lt;/p&gt;</div><div class="line">  &lt;div ng-controller=&quot;DemoController&quot;&gt;</div><div class="line">    &lt;p&gt;&#123;&#123;content&#125;&#125;&lt;/p&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;</div><div class="line">  function DemoController($scope)&#123;</div><div class="line">    $scope.content = &quot;简单的控制器例子&quot;;</div><div class="line">  &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>以上是一个最简单的例子。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;html lang=&quot;en&quot; ng-app&gt;</div></pre></td></tr></table></figure>
<p>html 的 <code>ng-app</code> 属性表明在该页面中启用 angularjs。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;p&gt;1 + 2 = &#123;&#123; 1 + 2 &#125;&#125;&lt;/p&gt;</div></pre></td></tr></table></figure>
<p>在页面加载完成之后 angularjs 会解析大括号内的表达式，并进行渲染。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-controller=&quot;DemoController&quot;&gt;</div><div class="line">  &lt;p&gt;&#123;&#123;content&#125;&#125;&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p><code>ng-controller</code> 表示在该标签下定义一个控制器。一个控制器就是一个普通的 js 函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;</div><div class="line">  function DemoController($scope)&#123;</div><div class="line">    $scope.content = &quot;简单的控制器例子&quot;;</div><div class="line">  &#125;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>这里定义 <code>DemoController</code> 控制器函数，并传入一个 <code>$scope</code> 参数，它是用于表示该控制器的上下文。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84147.html" data-id="cjoslv00k00p0sh081bxoa076" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-/archives/84146.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84146.html" class="article-date">
  <time datetime="2015-08-03T16:01:52.000Z" itemprop="datePublished">2015-08-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Ruby栏目/">Ruby栏目</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84146.html">unicorn是如何与nginx通讯的——介绍ruby中的unix socket</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Ruby 应用服务典型地是与一个 web 服务一同使用的，如 nginx。当用户请求你的 Rails 应用中的页面时，nginx 将请求指派给应用服务。<br>然而这个过程是如何完成的呢？nginx 与 unicorn 是如何通讯的呢？</p>
<p>最有效的一种选择是使用 unix 套接字(sockets)。让我们来看看它们是如何工作的！<br>在这篇文章中我们将从一个基本的套接字(sockets)开始，最后将创建一个使用 nginx 代理的简单应用服务。</p>
<p><img src="/wp-content/uploads/2015/07/socket.png" alt="socket"></p>
<p><em>套接字(sockets)允许进程之间通过对一个文件读或者写进行相互通讯。</em><br><em>在这个例子中 Unicorn 创建 socket 并监听它的连接。然后 Nginx 就可以连接到这个 socket 并与 Unicorn 通讯了。</em></p>
<h2 id="什么是-unix-socket？"><a href="#什么是-unix-socket？" class="headerlink" title="什么是 unix socket？"></a>什么是 unix socket？</h2><p>Unix socket 使得一个进程通过类似文件的方式与另一个进程进行通讯。它是 IPC(Interprocess Communication) 的一种。</p>
<p>要使得可以通过 socket 访问进程，首先需要创建一个 socket 并作为一个文件保存在磁盘中。<br>然后监听这个 socket 的连入连接。当接收到一个连接时，就可以使用<a href="http://ruby-doc.org/core-2.2.2/IO.html#method-i-readline" target="_blank" rel="external">标准 IO 方法</a>进行读写数据。</p>
<p>Ruby 通过以下一组类提供了 unix socket 所需的所有内容：</p>
<ul>
<li>UNIXServer - 创建 socket 并保存到磁盘中，并且让你可以监听新连接。</li>
<li>UNIXSocket - 打开已存在的套接字(sockets)。</li>
</ul>
<p><strong>注意：</strong>还存在着其它类型的 socket，最突出的是 TCP socket。不过这篇文章只处理 unix socket。那么它们之间的区别是什么呢？unix  socket 具有文件名。</p>
<h2 id="最简单的-Socket"><a href="#最简单的-Socket" class="headerlink" title="最简单的 Socket"></a>最简单的 Socket</h2><p>我们接下来看两个小程序。</p>
<p>第一个是服务端，它创建一个 <code>UnixServer</code> 实例，然后使用 <code>server.accept</code> 等待连接。当收到连接后则相互问候。</p>
<p>需要说明一下，<code>accept</code> 和 <code>readline</code> 方法都会阻塞程序的执行，直到收到内容。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">"socket"</span></div><div class="line"> </div><div class="line">server = UNIXServer.new(<span class="string">'/tmp/simple.sock'</span>)</div><div class="line"> </div><div class="line">puts <span class="string">"==== Waiting for connection"</span></div><div class="line">socket = server.accept</div><div class="line"> </div><div class="line">puts <span class="string">"==== Got Request:"</span></div><div class="line">puts socket.readline</div><div class="line"> </div><div class="line">puts <span class="string">"==== Sending Response"</span></div><div class="line">socket.write(<span class="string">"I read you loud and clear, good buddy!"</span>)</div><div class="line"> </div><div class="line">socket.close</div></pre></td></tr></table></figure>
<p>这里我们有了服务端，现在还需要客户端。</p>
<p>在下面这个例子中，我们打开由服务端创建的 socket，然后使用普通的 IO 方法进行发送和接收问候。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">"socket"</span></div><div class="line"> </div><div class="line">socket = UNIXSocket.new(<span class="string">'/tmp/simple.sock'</span>)</div><div class="line"> </div><div class="line">puts <span class="string">"==== Sending"</span></div><div class="line">socket.write(<span class="string">"Hello server, can you hear me?\n"</span>)</div><div class="line"> </div><div class="line">puts <span class="string">"==== Getting Response"</span></div><div class="line">puts socket.readline</div><div class="line"> </div><div class="line">socket.close</div></pre></td></tr></table></figure>
<p>演示一下程序，先运行服务端，然后再运行客户端。你可以看到以下结果：</p>
<p><img src="/wp-content/uploads/2015/07/simple_ruby_socket_example.png" alt="simple_ruby_socket_example"><br><em>简单的 Unix socket 服务端/客户端交互的例子。左边是客户端，右边是服务端。</em></p>
<h2 id="与-nginx-接合"><a href="#与-nginx-接合" class="headerlink" title="与 nginx 接合"></a>与 nginx 接合</h2><p>现在我们知道如何创建一个 unix socket 的服务端了，我们可以很容易地与 nginx 接合。</p>
<p>不相信我？让我们来做一个快速的概念验证吧。我修改上面的代码使其输出从 socket 接收到的所有内容。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">"socket"</span></div><div class="line"> </div><div class="line"><span class="comment"># Create the socket and "save it" to the file system</span></div><div class="line">server = UNIXServer.new(<span class="string">'/tmp/socktest.sock'</span>)</div><div class="line"> </div><div class="line"><span class="comment"># Wait until for a connection (by nginx)</span></div><div class="line">socket = server.accept</div><div class="line"> </div><div class="line"><span class="comment"># Read everything from the socket</span></div><div class="line"><span class="keyword">while</span> line = socket.readline</div><div class="line">  puts line.inspect</div><div class="line"><span class="keyword">end</span></div><div class="line"> </div><div class="line">socket.close</div></pre></td></tr></table></figure>
<p>现在如果我修改 nginx 配置，将请求转发到 <code>/tmp/socktest.sock</code> socket 上。<br>我就能看到 nginx 发送来的数据了。(别担心，我们稍后会讨论它的配置的)</p>
<p>当我发起一个 web 请求时，nginx 将如下数据发送到我的服务端上：</p>
<p><img src="/wp-content/uploads/2015/07/request_http.png" alt="request_http"></p>
<p>太酷了！这就是一个包含了额外头信息的 HTTP 请求。现在我们准备来构建一个真正的应用服务。<br>但是，首先让我们讨论一个 nginx 的配置吧。</p>
<h2 id="安装配置-Nginx"><a href="#安装配置-Nginx" class="headerlink" title="安装配置 Nginx"></a>安装配置 Nginx</h2><p>如果你还没有安装 nginx 的话，请先安装。对于 OSX 可以 homebrew 简单完成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install nginx</div></pre></td></tr></table></figure>
<p>现在我们配置 nginx 将 localhost:2048 的请求通过名为 <code>/tmp/socktest.sock</code> 的 socket 转发到上游服务端。<br>名字可以是任意的，它仅需要与我们 web 服务的 socket 名字匹配即可。</p>
<p>你可以将其保存至 <code>/tmp/nginx.conf</code> 并通过命令 <code>nginx -c /tmp/nginx.conf</code> 运行 nginx。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"># Run nginx as a normal console program, not as a daemon</div><div class="line">daemon off;</div><div class="line"> </div><div class="line"># Log errors to stdout</div><div class="line">error_log /dev/stdout info;</div><div class="line"> </div><div class="line">events &#123;&#125; # Boilerplate</div><div class="line"> </div><div class="line">http &#123;</div><div class="line"> </div><div class="line">  # Print the access log to stdout</div><div class="line">  access_log /dev/stdout;</div><div class="line"> </div><div class="line">  # Tell nginx that there&apos;s an external server called @app living at our socket</div><div class="line">  upstream app &#123;</div><div class="line">    server unix:/tmp/socktest.sock fail_timeout=0;</div><div class="line">  &#125;</div><div class="line"> </div><div class="line">  server &#123;</div><div class="line"> </div><div class="line">    # Accept connections on localhost:2048</div><div class="line">    listen 2048;</div><div class="line">    server_name localhost;</div><div class="line"> </div><div class="line">    # Application root</div><div class="line">    root /tmp;</div><div class="line"> </div><div class="line">    # If a path doesn&apos;t exist on disk, forward the request to @app</div><div class="line">    try_files $uri/index.html $uri @app;</div><div class="line"> </div><div class="line">    # Set some configuration options on requests forwarded to @app</div><div class="line">    location @app &#123;</div><div class="line">      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</div><div class="line">      proxy_set_header Host $http_host;</div><div class="line">      proxy_redirect off;</div><div class="line">      proxy_pass http://app;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以非后台模式运行 nginx。当你运行 nginx 时它应该看起来像如下这样：</p>
<p><img src="/wp-content/uploads/2015/07/nginx_non_daemon.png" alt="nginx_non_daemon"><br><em>Nginx 以非后台模式运行</em></p>
<h2 id="自定义应用服务"><a href="#自定义应用服务" class="headerlink" title="自定义应用服务"></a>自定义应用服务</h2><p>既然我们已经知道了如何将 nginx 与我们程序进行连接，那么我们就来构建一个简单的应用服务。<br>当 nginx 将请求转发到我们的 socket 时，它是一个标准的 HTTP 请求。<br>经过一些处理后我可以决定 socket 是否会返回一个有效的 HTTP 响应，它会在浏览器中显示。</p>
<p>下面这个应用接受任何请求并显示时间戳。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">"socket"</span></div><div class="line"> </div><div class="line"><span class="comment"># Connection creates the socket and accepts new connections</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Connection</span></span></div><div class="line"> </div><div class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:path</span></div><div class="line"> </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(<span class="symbol">path:</span>)</span></span></div><div class="line">    @path = path</div><div class="line">    File.unlink(path) <span class="keyword">if</span> File.exists?(path)</div><div class="line">  <span class="keyword">end</span></div><div class="line"> </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">server</span></span></div><div class="line">    @server <span class="params">||</span>= UNIXServer.new(@path)</div><div class="line">  <span class="keyword">end</span></div><div class="line"> </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">on_request</span></span></div><div class="line">    socket = server.accept</div><div class="line">    <span class="keyword">yield</span>(socket)</div><div class="line">    socket.close</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"> </div><div class="line"> </div><div class="line"><span class="comment"># AppServer logs incoming requests and renders a view in response</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppServer</span></span></div><div class="line"> </div><div class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:connection</span></div><div class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:view</span></div><div class="line"> </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(<span class="symbol">connection:</span>, <span class="symbol">view:</span>)</span></span></div><div class="line">    @connection = connection</div><div class="line">    @view = view</div><div class="line">  <span class="keyword">end</span></div><div class="line"> </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span></span></div><div class="line">    <span class="keyword">while</span> <span class="literal">true</span></div><div class="line">      connection.on_request <span class="keyword">do</span> <span class="params">|socket|</span></div><div class="line">        <span class="keyword">while</span> (line = socket.readline) != <span class="string">"\r\n"</span></div><div class="line">          puts line</div><div class="line">        <span class="keyword">end</span></div><div class="line">        socket.write(view.render)</div><div class="line">      <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"> </div><div class="line"><span class="keyword">end</span></div><div class="line"> </div><div class="line"><span class="comment"># TimeView simply provides the HTTP response</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TimeView</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">render</span></span></div><div class="line"><span class="string">%[HTTP/1.1 200 OK</span></div><div class="line"> </div><div class="line"> </div><div class="line">The current timestamp is: <span class="subst">#&#123; Time.now.to_i &#125;</span></div><div class="line"> </div><div class="line">]</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"> </div><div class="line"> </div><div class="line">AppServer.new(<span class="symbol">connection:</span> Connection.new(<span class="symbol">path:</span> <span class="string">'/tmp/socktest.sock'</span>), <span class="symbol">view:</span> TimeView.new).run</div></pre></td></tr></table></figure>
<p>现在运行 nginx 和脚本，然后访问 localhost:2048。请求会发送到我的应用上，然后响应被浏览器渲染。太酷了！</p>
<p><img src="/wp-content/uploads/2015/07/appserver.png" alt="appserver"><br><em>HTTP 请求信息由我们的应用服务输出到 STDOUT</em></p>
<p>以下就是我们的劳动成果。</p>
<p><img src="/wp-content/uploads/2015/07/timestamp.png" alt="timestamp"><br><em>浏览器中显示服务端返回的时间戳</em></p>
<p>原文地址： <a href="http://blog.honeybadger.io/how-unicorn-talks-to-nginx-an-introduction-to-unix-sockets-in-ruby/" target="_blank" rel="external">http://blog.honeybadger.io/how-unicorn-talks-to-nginx-an-introduction-to-unix-sockets-in-ruby/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84146.html" data-id="cjoslv00i00oxsh08dmek7c0e" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/翻译/">翻译</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-/archives/84145.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84145.html" class="article-date">
  <time datetime="2015-05-14T21:24:21.000Z" itemprop="datePublished">2015-05-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Ruby栏目/">Ruby栏目</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84145.html">Ruby的内存陷阱</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Ruby有一套自动的内存管理机制。这在大多数情况下是不错的，但是有时它却是个麻烦。</p>
<p>Ruby的内存管理既简洁又笨重。它将对象（名为 <code>RVALUE</code>）存储在大约有16KB大小的堆中。<br>从底层上，<code>RVALUE</code> 是一个 <code>C</code> 的结构体，它包含了一个共同体表示不同的标准ruby对象。</p>
<p>因此在堆中存储着大小不超过40字节的 <code>RVALUE</code> 对象，如 <code>String</code>、<code>Array</code>、<code>Hash</code>等。<br>这意味着小的对象在堆中很合适，但是一旦它们达到到阈值，那么就需要在Ruby的堆之外再分配一片额外的内存。</p>
<p><strong>这块额外的内存空间是灵活的。一旦对象被垃圾回收了它就会被释放掉。但是堆本身的内存是不会被释放给操作系统的。</strong></p>
<p>让我们来看一个简单的例子：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">report</span></span></div><div class="line">  puts <span class="string">'Memory '</span> + <span class="string">`ps ax -o pid,rss | grep -E "^[[:space:]]*<span class="subst">#&#123;$$&#125;</span>"`</span></div><div class="line">          .strip.split.map(&amp;<span class="symbol">:to_i</span>)[<span class="number">1</span>].to_s + <span class="string">'KB'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">report</div><div class="line">big_var = <span class="string">" "</span> * <span class="number">10_000_000</span></div><div class="line">report</div><div class="line">big_var = <span class="literal">nil</span></div><div class="line">report</div><div class="line">ObjectSpace.garbage_collect</div><div class="line">sleep <span class="number">1</span></div><div class="line">report</div><div class="line"></div><div class="line"><span class="comment"># ⇒ Memory 11788KB</span></div><div class="line"><span class="comment"># ⇒ Memory 65188KB</span></div><div class="line"><span class="comment"># ⇒ Memory 65188KB</span></div><div class="line"><span class="comment"># ⇒ Memory 11788KB</span></div></pre></td></tr></table></figure>
<p>这里我们分配了大量的内存，使用完后又释放给操作系统。这一切看起来似乎没有问题。现在让我们稍微修改一下代码：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-  big_var = <span class="string">" "</span> * <span class="number">10_000_000</span></div><div class="line">+  big_var = <span class="number">1_000_000</span>.times.map(&amp;<span class="symbol">:to_s</span>)</div></pre></td></tr></table></figure>
<p>这只是一个简单的修改，不是吗。但是结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># ⇒ Memory 11788KB</div><div class="line"># ⇒ Memory 65188KB</div><div class="line"># ⇒ Memory 65188KB</div><div class="line"># ⇒ Memory 57448KB</div></pre></td></tr></table></figure>
<p>怎么回事？内存没有释放归还给操作系统。这是因为数组中的每个元素符合 <code>RVALUE</code> 的大小并存储在ruby的堆中。</p>
<p>在大多情况下这是正常的。现在ruby堆中多了许多空的位置，再次运行代码将不会再消耗额外的内存了。<br>每次我们处理 <code>big_var</code> 和一些空的堆时， <code>GC[:heap_used]</code>的值果然减小了。<br>对于这些操作Ruby是早有准备，注意这里是Ruby而不是操作系统。</p>
<p>因此，对于创建大量的符合40个字节的临时变量就要注意了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">big_var = &quot; &quot; * 10_000_000</div><div class="line">big_var.gsub(/\s/) &#123; |c| &apos;-&apos; &#125;</div></pre></td></tr></table></figure>
<p>结果同样是Ruby的内存疯狂增长，并且这部分内存在程序运行期间是不会归还给操作系统的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># ⇒ Memory 10156KB</div><div class="line"># ⇒ Memory 13788KB</div><div class="line"># ⇒ Memory 13788KB</div><div class="line"># ⇒ Memory 12808KB</div></pre></td></tr></table></figure>
<p>这个问题不是太重要，稍微注意一下即可。</p>
<p>原文地址：<a href="http://rocket-science.ru/hacking/2013/12/17/ruby-memory-pitfalls/" target="_blank" rel="external">http://rocket-science.ru/hacking/2013/12/17/ruby-memory-pitfalls/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84145.html" data-id="cjoslv00h00otsh086z9kj031" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/翻译/">翻译</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-/archives/84144.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84144.html" class="article-date">
  <time datetime="2015-05-13T21:33:08.000Z" itemprop="datePublished">2015-05-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Ruby栏目/">Ruby栏目</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84144.html">未来的Ruby 3.0</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文地址：<a href="http://hrnabi.com/2015/05/12/7035/" target="_blank" rel="external">http://hrnabi.com/2015/05/12/7035/</a><br>谁日语好的为大家做下贡献，把原文翻译一下吧。</p>
<p>反正我不会日语，根据文中的一些汉字连蒙带猜的，大致看了一遍，现在简单总结一下。<br>如果有总结得不对的，本人不负责哦。</p>
<p>看来要玩好Ruby不仅需要学英语，也还得学日语啊。</p>
<hr>
<p>在2014年9月举行的 RubyKaigi 2014 大会上，Matz在演讲过程中首次提到了 Ruby 3.0。<br>文中说的Ruby 3.0的三个工作方向：</p>
<ul>
<li>Concurrency (并行性)</li>
<li>JIT (即时编译)</li>
<li>Static typing (静态类型)</li>
</ul>
<p>Ruby要引入静态类型检查？<br>Matz说，在20世纪出生的语言大多是脚本语言，如：Ruby、PHP和Perl、JavaScript，这些都不是静态类型的。<br>另一方面，最近推出的如Scala和Dart、Go是属于静态类型的。<br>在Ruby中可以考虑引入Python这种通过注释来进行检查的方法。</p>
<p>Ruby要引入并行计算？<br>Matz详细讨论了静态类型，但没有提到并行计算。详细的内容是由笹田氏来说的。<br>（这部分内容我没看懂，只是大概知道这位笹田氏的博士论文与这个相关。）<br>关于并行计算，Matz提到了Erlang和Scala的actor模型。</p>
<p>最后期待下一个Ruby开发者大会。</p>
<hr>
<p>好了，我只看懂了这么多。其余的各位感兴趣的自己去看原文吧。<br>(怎么感觉好坑啊，这总结得跟没总结一样啊。没办法了我的日语水平有限。)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84144.html" data-id="cjoslv00f00oqsh08tse390fs" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-/archives/84143.html" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/archives/84143.html" class="article-date">
  <time datetime="2015-04-30T22:35:42.000Z" itemprop="datePublished">2015-04-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Ruby栏目/">Ruby栏目</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/archives/84143.html">Ruby中一些重要的钩子方法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Ruby的哲学理念是基于一个基本的要素，那就是让程序员快乐。Ruby非常注重程序员的快乐，并且也提供了许多不同的方法来实现它。<br>它的元编程能力能够让程序员编写在运行时动态生成的代码。它的线程功能使得程序员有一种优雅的的方式编写多线程代码。<br>它的钩子方法能让程序员在程序运行时扩展它的行为。</p>
<p>上述的这些特性，以及一些其他很酷的语言方面，使得Ruby成为编写代码的优先选择之一。<br>本文将探讨Ruby中的一些重要的钩子方法。我们将从不同方面讨论钩子方法，如它们是什么，它们用于什么，以及我们如何使用它们来解决不同的问题。<br>我们同时也了解一下一些流行的Ruby框架/Gem包/库是如何使用它们来提供非常酷的特性的。</p>
<p>我们开始吧。</p>
<h1 id="什么是钩子方法？"><a href="#什么是钩子方法？" class="headerlink" title="什么是钩子方法？"></a>什么是钩子方法？</h1><p>钩子方法提供了一种方式用于在程序运行时扩展程序的行为。<br>假设有这样的功能，可以在无论何时一个子类继承了一些特定的父类时收到通知，<br>或者是比较优雅地处理一个对象上的不可调用的方法而不是让编译器抛出异常。<br>这些情况就是使用钩子方法，但是它们的用法并不仅限于此。<br>不同的框架/库使用了不同的钩子方法来实现它们的功能。</p>
<p>在本文中我们将会讨论如下几个钩子方法：</p>
<ul>
<li>included</li>
<li>extended</li>
<li>prepended</li>
<li>inherited</li>
<li>method_missing</li>
</ul>
<h2 id="included"><a href="#included" class="headerlink" title="included"></a>included</h2><p>Ruby给我们提供了一种方式使用 <code>模块(modules)</code> （在其他语言中被称作 <code>混入类(mixins)</code>）来编写模块化的代码供其他的 <code>模块</code>/<code>类</code> 使用。<br><code>模块</code> 的概念很简单，它就是一个可以在其他地方使用的独立代码块。</p>
<p>例如，如果我们想要编写一些代码在任何时候调用特定的方法都会返回一个静态字符串。<br>我们姑且将这个方法称作 <code>name</code>。你可能在其他地方也会想使用同一块代码。<br>这样最好是新建一个模块。让我们来创建一个：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    puts <span class="string">"My name is Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>这是一个非常简单的模块，仅有一个 <code>name</code> 方法用于返回一个静态字符串。在我们的程序中使用这个模块：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></div><div class="line">  <span class="keyword">include</span> Person</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>Ruby提供了一些不同的方法来使用<code>模块</code>。<code>include</code> 是其中之一。<code>include</code> 所做的就是将在 <code>module</code> 内定义的方法在一个 <code>class</code> 的实例变量上可用。<br>在我们的例子中，是将 <code>Person</code> 模块中定义的方法变为一个 <code>User</code> 类实例对象的方法。<br>这就相当于我们是将 <code>name</code> 方法写在 <code>User</code> 类里一样，但是定义在 <code>module</code> 里的好处是可复用。<br>要调用 <code>name</code> 方法我们需要创建一个 <code>User</code> 的实例对象，然后再在这个对象上调用 <code>name</code> 方法。例如：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">User.new.name</div><div class="line">=&gt; My name is Person</div></pre></td></tr></table></figure>
<p>让我们看看基于 <code>include</code> 的钩子方法。<code>included</code> 是Ruby提供的一个钩子方法，当你在一些 <code>module</code> 或者 <code>class</code> 中 <code>include</code> 了一个 <code>module</code> 时它会被调用。<br>更新 <code>Person</code> 模块：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">included</span><span class="params">(base)</span></span></div><div class="line">    puts <span class="string">"<span class="subst">#&#123;base&#125;</span> included <span class="subst">#&#123;<span class="keyword">self</span>&#125;</span>"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"> </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name is Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>你可以看到一个新的方法 <code>included</code> 被定义为 <code>Person</code> 模块的类方法。当你在其他的模块或者类中执行 <code>include Person</code> 时，这个 <code>included</code> 方法会被调用。<br>该方法接收的一个参数是对包含该模块的类的引用。试试运行 <code>User.new.name</code>，你会看到如下的输出：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">User included Person</div><div class="line">My name is Person</div></pre></td></tr></table></figure>
<p>正如你所见，<code>base</code> 返回的是包含该模块的类名。现在我们有了一个包含 <code>Person</code> 模块的类的引用，我们可以通过元编程来实现我们想要的功能。<br>让我们来看看 <strong>Devise</strong>是如何使用 <code>included</code> 钩子的。</p>
<h3 id="Devise中的-included"><a href="#Devise中的-included" class="headerlink" title="Devise中的 included"></a>Devise中的 <code>included</code></h3><p>Devise是Ruby中使用最广泛的身份验证gem包之一。它主要是由我喜欢的程序员 <a href="https://twitter.com/josevalim" target="_blank" rel="external">José Valim</a> 开发的，现在是由一些了不起的贡献者在维护。<br>Devise为我们提供了从注册到登录，从忘记密码到找回密码等等完善的功能。它可以让我们在用户模型中使用简单的语法来配置各种模块：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">devise <span class="symbol">:database_authenticatable</span>, <span class="symbol">:registerable</span>, <span class="symbol">:validatable</span></div></pre></td></tr></table></figure>
<p>在我们模型中使用的 <code>devise</code> 方法在<a href="https://github.com/plataformatec/devise/blob/v3.4.1/lib/devise/models.rb#L77" target="_blank" rel="external">这里</a>定义。<br>为了方便我将这段代码粘贴在下面：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">devise</span><span class="params">(*modules)</span></span></div><div class="line">  options = modules.extract_options!.dup</div><div class="line"> </div><div class="line">  selected_modules = modules.map(&amp;<span class="symbol">:to_sym</span>).uniq.sort_by <span class="keyword">do</span> <span class="params">|s|</span></div><div class="line">    Devise::ALL.index(s) <span class="params">||</span> -<span class="number">1</span>  <span class="comment"># follow Devise::ALL order</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"> </div><div class="line">  devise_modules_hook! <span class="keyword">do</span></div><div class="line">    <span class="keyword">include</span> Devise::Models::Authenticatable</div><div class="line"> </div><div class="line">    selected_modules.each <span class="keyword">do</span> <span class="params">|m|</span></div><div class="line">      mod = Devise::Models.const_get(m.to_s.classify)</div><div class="line"> </div><div class="line">      <span class="keyword">if</span> mod.const_defined?(<span class="string">"ClassMethods"</span>)</div><div class="line">        class_mod = mod.const_get(<span class="string">"ClassMethods"</span>)</div><div class="line">        extend class_mod</div><div class="line"> </div><div class="line">        <span class="keyword">if</span> class_mod.respond_to?(<span class="symbol">:available_configs</span>)</div><div class="line">          available_configs = class_mod.available_configs</div><div class="line">          available_configs.each <span class="keyword">do</span> <span class="params">|config|</span></div><div class="line">            <span class="keyword">next</span> <span class="keyword">unless</span> options.key?(config)</div><div class="line">            send(<span class="symbol">:<span class="string">"<span class="subst">#&#123;config&#125;</span>="</span></span>, options.delete(config))</div><div class="line">          <span class="keyword">end</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">      <span class="keyword">end</span></div><div class="line"> </div><div class="line">      <span class="keyword">include</span> mod</div><div class="line">    <span class="keyword">end</span></div><div class="line"> </div><div class="line">    <span class="keyword">self</span>.devise_modules <span class="params">|= selected_modules</span></div><div class="line">    options.each &#123; |key, value<span class="params">| send(:"#&#123;key&#125;=", value) &#125;</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>在我们的模型中传给 <code>devise</code> 方法的模块名将会作为一个数组保存在 <code>*modules</code> 中。<br>对于传入的模块调用 <code>extract_options!</code> 方法提取可能传入的选项。<br>在11行中调用 <code>each</code> 方法，并且每个模块在代码块中用 <code>m</code> 表示。<br>在12行中 <code>m</code> 将会转化为一个常量（类名），因此使用 <code>m.to.classify</code> 一个例如 <code>:validatable</code> 这样的符号会变为 <code>Validatable</code> 。<br>随便说一下 <code>classify</code> 是ActiveSupport的方法。<br><code>Devise::Models.const_get(m.to_classify)</code> 会获取该模块的引用，并赋值给 <code>mod</code>。<br>在27行使用 <code>include mod</code> 包含该模块。<br>例子中的 <code>Validatable</code> 模块是定义在<a href="https://github.com/plataformatec/devise/blob/v3.4.1/lib/devise/models/validatable.rb" target="_blank" rel="external">这里</a>。<br><code>Validatable</code> 的 <code>included</code> 钩子方法定义如下：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">included</span><span class="params">(base)</span></span></div><div class="line">  base.extend ClassMethods</div><div class="line">  assert_validations_api!(base)</div><div class="line"> </div><div class="line">  base.class_eval <span class="keyword">do</span></div><div class="line">    validates_presence_of   <span class="symbol">:email</span>, <span class="symbol">if:</span> <span class="symbol">:email_required?</span></div><div class="line">    validates_uniqueness_of <span class="symbol">:email</span>, <span class="symbol">allow_blank:</span> <span class="literal">true</span>, <span class="symbol">if:</span> <span class="symbol">:email_changed?</span></div><div class="line">    validates_format_of     <span class="symbol">:email</span>, <span class="symbol">with:</span> email_regexp, <span class="symbol">allow_blank:</span> <span class="literal">true</span>, <span class="symbol">if:</span> <span class="symbol">:email_changed?</span></div><div class="line"> </div><div class="line">    validates_presence_of     <span class="symbol">:password</span>, <span class="symbol">if:</span> <span class="symbol">:password_required?</span></div><div class="line">    validates_confirmation_of <span class="symbol">:password</span>, <span class="symbol">if:</span> <span class="symbol">:password_required?</span></div><div class="line">    validates_length_of       <span class="symbol">:password</span>, <span class="symbol">within:</span> password_length, <span class="symbol">allow_blank:</span> <span class="literal">true</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>此时模型是 <code>base</code>。在第5行的 <code>class_eval</code> 代码块会以该类作为上下文进行求值运算。<br>通过 <code>class_eval</code> 编写的代码与直接打开该类的文件将代码粘贴进去效果是一样的。<br>Devise是通过 <code>class_eval</code> 将验证包含到我们的用户模型中的。</p>
<p>当我们试着使用Devise注册或者登录时，我们会看到这些验证，但是我们并没有编写这些验证代码。<br>Devise是利用了 <code>included</code> 钩子来实现这些的。非常的优雅吧。</p>
<h2 id="extended"><a href="#extended" class="headerlink" title="extended"></a>extended</h2><p>Ruby也允许开发者 <code>扩展(extend)</code> 一个模块，这与 <code>包含(include)</code> 有点不同。<br><code>extend</code> 是将定义在 <code>模块(module)</code> 内的方法应用为类的方法，而不是实例的方法。<br>让我们来看一个简单的例子：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name is Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></div><div class="line">  extend Person</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">puts User.name <span class="comment"># =&gt; My name is Person</span></div></pre></td></tr></table></figure>
<p>正如你所看到的，我们将 <code>Person</code> 模块内定义的 <code>name</code> 方法作为了 <code>User</code> 的类方法调用。<br><code>extend</code> 将 <code>Person</code> 模块内的方法添加到了 <code>User</code> 类中。<code>extend</code> 同样也可以用于将模块内的方法作为单例方法(singleton methods)。<br>让我们再来看另外一个例子：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># We are using same Person module and User class from previous example.     </span></div><div class="line"></div><div class="line">u1 = User.new</div><div class="line">u2 = User.new</div><div class="line"></div><div class="line">u1.extend Person</div><div class="line"></div><div class="line">puts u1.name <span class="comment"># =&gt; My name is Person</span></div><div class="line">puts u2.name <span class="comment"># =&gt; undefined method `name' for #&lt;User:0x007fb8aaa2ab38&gt; (NoMethodError)</span></div></pre></td></tr></table></figure>
<p>我们创建了两个 <code>User</code> 的实例对象，并将 <code>Person</code> 作为参数在 <code>u1</code> 上调用 <code>extend</code> 方法。<br>使用这种调用方式，<code>Person</code> 的 <code>name</code> 方法仅对 <code>u1</code> 有效，对于其他实例是无效的。</p>
<p>正如 <code>included</code> 一样，与 <code>extend</code> 相对应的钩子方法是 <code>extended</code>。<br>当一个模块被其他模块或者类执行了 <code>extend</code> 操作时，该方法将会被调用。<br>让我们来看一个例子：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Modified version of Person module</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">extended</span><span class="params">(base)</span></span></div><div class="line">    puts <span class="string">"<span class="subst">#&#123;base&#125;</span> extended <span class="subst">#&#123;<span class="keyword">self</span>&#125;</span>"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name is Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></div><div class="line">  extend Person</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>该代码的运行结果是输出 <code>User extended Person</code>。</p>
<p>关于 <code>extended</code> 的介绍已经完了，让我们来看看 <code>ActiveRecord</code> 是如何使用它的。</p>
<h3 id="ActiveRecord中的-extended"><a href="#ActiveRecord中的-extended" class="headerlink" title="ActiveRecord中的 extended"></a>ActiveRecord中的 <code>extended</code></h3><p><code>ActiveRecord</code> 是在 Ruby 以及 Rails 中广泛使用的ORM框架。它具有许多酷的特性，<br>因此使用它在很多情况下成为了ORM的首选。让我们进入 <code>ActiveRecord</code> 内部看看 <code>ActiveRecord</code> 是如何使用回调的。<br>(我们使用的是 Rails v3.2.21)</p>
<p><code>ActiveRecord</code> 在<a href="https://github.com/rails/rails/blob/v3.2.21/activerecord/lib/active_record/callbacks.rb#L246" target="_blank" rel="external">这里</a> <code>extend</code> 了 <code>ActiveRecord::Models</code> 模块。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">extend ActiveModel::Callbacks</div></pre></td></tr></table></figure>
<p><code>ActiveModel</code> 提供了一套在模型类中使用的接口。它们允许 ActionPack 与不是 ActiveRecord 的模型进行交互。<br>在<a href="https://github.com/rails/rails/blob/v3.2.21/activemodel/lib/active_model/callbacks.rb#L49-L53" target="_blank" rel="external">这里</a>， <code>ActiveModel::Callbacks</code> 内部你将会看到如下代码：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">extended</span><span class="params">(base)</span></span></div><div class="line">  base.class_eval <span class="keyword">do</span></div><div class="line">    <span class="keyword">include</span> ActiveSupport::Callbacks</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p><code>ActiveModel::Callbacks</code> 对 <code>base</code> 即就是 <code>ActiveRecord::Callbacks</code> 调用了 <code>class_eval</code> 方法，<br>并包含了 <code>ActiveSupport::Callbacks</code> 模块。我们前面已经提到过了，对一个类调用 <code>class_eval</code> 与手动地将代码写在这个类里是一样的。<br><code>ActiveSupport::Callbacks</code> 为 <code>ActiveRecord::Callbacks</code> 提供了 Rails 中的回调方法。</p>
<p>这里我们讨论了 <code>extend</code> 方法，以及与之对应的钩子 <code>extended</code>。并且也了解了 <code>ActiveRecord</code> / <code>ActiveModel</code><br>是如何使用上述方法为我们提供可用功能的。</p>
<h2 id="prepended"><a href="#prepended" class="headerlink" title="prepended"></a>prepended</h2><p>另一个使用定义在模块内部方法的方式称为 <code>prepend</code>。<code>prepend</code> 是在Ruby 2.0中引入的，并且与 <code>include</code> 和 <code>extend</code> 很不一样。<br>使用 <code>include</code> 和 <code>extend</code> 引入的方法可以被目标模块/类重新定义覆盖。<br>例如，如果我们在某个模块中定义了一个名为 <code>name</code> 的方法，并且在目标模块/类中也定义同名的方法。<br>那么这个在我们类在定义的 <code>name</code> 方法将会覆盖模块中的。而 <code>prepend</code> 是不一样的，它会将 <code>prepend</code> 引入的模块<br>中的方法覆盖掉我们模块/类中定义的方法。让我们来看一个简单的例子：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name belongs to Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></div><div class="line">  <span class="keyword">include</span> Person</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name belongs to User"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">puts User.new.name </div><div class="line">=&gt; My name belongs to User</div></pre></td></tr></table></figure>
<p>现在再来看看 <code>prepend</code> 的情况：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name belongs to Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></div><div class="line">  prepend Person</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name belongs to User"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">puts User.new.name </div><div class="line">=&gt; My name belongs to Person</div></pre></td></tr></table></figure>
<p>使用 <code>prepend Person</code> 会将 <code>User</code> 中的同名方法给覆盖掉，因此在终端输出的结果为 <code>My name belongs to Person</code>。<br><code>prepend</code> 实际上是将方法添加到方法链的前端。在调用 <code>User</code> 类内定义的 <code>name</code> 方法时，会调用 <code>super</code> 从而调用 <code>Person</code> 模块的 <code>name</code>。</p>
<p>与 <code>prepend</code> 对应的回调名为（你应该猜到了） <code>prepended</code>。当一个模块被预置到另一个模块/类中时它会被调用。<br>我们来看下效果。更新 <code>Person</code> 模块的定义：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">prepended</span><span class="params">(base)</span></span></div><div class="line">    puts <span class="string">"<span class="subst">#&#123;<span class="keyword">self</span>&#125;</span> prepended to <span class="subst">#&#123;base&#125;</span>"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name belongs to Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>你再运行这段代码应该会看到如下结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Person prepended to User</div><div class="line">My name belongs to Person</div></pre></td></tr></table></figure>
<p><code>prepend</code> 的引入是为了去除 <code>alias_method_chain</code> hack的丑陋，它曾被Rails以及其他库广泛地使用以达到与 <code>prepend</code> 相同的功能。<br>因为 <code>prepend</code> 只有在 Ruby &gt;= 2.0 的版本中才能使用，因此如果你打算使用 <code>prepend</code> 的话，那么你就应该升级你的Ruby版本。</p>
<h2 id="inherited"><a href="#inherited" class="headerlink" title="inherited"></a>inherited</h2><p>继承是面向对象中一个最重要的概念。Ruby是一门面向对象的编程语言，并且提供了从基/父类继承一个子类的功能。<br>我们来看一个简单的例子：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">     <span class="string">"My name is Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; Person</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">puts User.new.name <span class="comment"># =&gt; My name is Person</span></div></pre></td></tr></table></figure>
<p>我们创建了一个 <code>Person</code> 类和一个子类 <code>User</code>。在 <code>Person</code> 中定义的方法也成为了 <code>User</code> 的一部分。<br>这是非常简单的继承。你可能会好奇，是否有什么方法可以在一个类被其他类继承时收到通知呢？<br>是的，Ruby有一个名为 <code>inherited</code> 的钩子可以实现。我们再看看这个例子：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">inherited</span><span class="params">(child_class)</span></span></div><div class="line">    puts <span class="string">"<span class="subst">#&#123;child_class&#125;</span> inherits <span class="subst">#&#123;<span class="keyword">self</span>&#125;</span>"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name is Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; Person</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">puts User.new.name</div></pre></td></tr></table></figure>
<p>正如你所见，当 <code>Person</code> 类被其他子类继承时 <code>inherited</code> 类方法将会被调用。<br>运行以上代码结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">User inherits Person</div><div class="line">My name is Person</div></pre></td></tr></table></figure>
<p>让我们看看 <code>Rails</code> 在它的代码中是如何使用 <code>inherited</code> 的。</p>
<h3 id="Rails中的-inherited"><a href="#Rails中的-inherited" class="headerlink" title="Rails中的 inherited"></a>Rails中的 <code>inherited</code></h3><p>Rails应用中有一个重要的类名为 <code>Application</code> ，定义中 <strong>config/application.rb</strong> 文件内。<br>这个类执行了许多不同的任务，如运行所有的Railties，引擎以及插件的初始化。<br>关于 <code>Application</code> 类的一个有趣的事件是，在同一个进程中不能运行两个实例。<br>如果我们尝试修改这个行为，Rails将会抛出一个异常。让我们来看看Rails是如何实现这个特性的。</p>
<p><code>Application</code> 类继承自 <code>Rails::Application</code>，它是在<a href="https://github.com/rails/rails/blob/v3.2.21/railties/lib/rails/application.rb" target="_blank" rel="external">这里</a>定义的。<br>在62行定义了 <code>inherited</code> 钩子，它会在我们的Rails应用 <code>Application</code> 类继承 <code>Rails::Application</code> 时被调用。<br><code>inherited</code> 钩子的代码如下：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> &lt;&lt; self</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">inherited</span><span class="params">(base)</span></span></div><div class="line">    raise <span class="string">"You cannot have more than one Rails::Application"</span> <span class="keyword">if</span> Rails.application</div><div class="line">    <span class="keyword">super</span></div><div class="line">    Rails.application = base.instance</div><div class="line">    Rails.application.add_lib_to_load_path!</div><div class="line">    ActiveSupport.run_load_hooks(<span class="symbol">:before_configuration</span>, base.instance)</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p><code>class &lt;&lt; self</code> 是Ruby中的另一个定义类方法的方式。在 <code>inherited</code> 中的第1行是检查 <code>Rails.application</code> 是否已存在。<br>如果存在则抛出异常。第一次运行这段代码时 <code>Rails.application</code> 会返回false然后调用 <code>super</code>。<br>在这里 <code>super</code> 即是 <code>Rails::Engine</code> 的 <code>inherited</code> 钩子，因为 <code>Rails::Application</code> 继承自 <code>Rails::Engine</code>。</p>
<p>在下一行，你会看到 <code>Rails.application</code> 被赋值为 <code>base.instance</code> 。其余就是设置Rails应用了。</p>
<p>这就是Rails如何巧妙地使用 <code>inherited</code> 钩子来实现我们的Rails <code>Application</code> 类的单实例。</p>
<h2 id="method-missing"><a href="#method-missing" class="headerlink" title="method_missing"></a>method_missing</h2><p><code>method_missing</code> 可能是Ruby中使用最广的钩子。在许多流行的Ruby框架/gem包/库中都有使用它。<br>当我们试图访问一个对象上不存在的方法时则会调用这个钩子方法。<br>让我们来看一个简单的例子：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name is Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"> </div><div class="line">p = Person.new</div><div class="line"> </div><div class="line">puts p.name     <span class="comment"># =&gt; My name is Person </span></div><div class="line">puts p.address  <span class="comment"># =&gt; undefined method `address' for #&lt;Person:0x007fb730a2b450&gt; (NoMethodError)</span></div></pre></td></tr></table></figure>
<p>我们定义了一个简单的 <code>Person</code> 类， 它只有一个 <code>name</code> 方法。然后创建一个 <code>Person</code> 的实例对象，<br>并分别调用 <code>name</code> 和 <code>address</code>　两个方法。因为 <code>Person</code> 中定义了 <code>name</code>，因此这个运行没问题。<br>然而 <code>Person</code> 并没有定义 <code>address</code>，这将会抛出一个异常。<br><code>method_missing</code> 钩子可以优雅地捕捉到这些未定义的方法，避免此类异常。<br>让我们修改一下 <code>Person</code> 类：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">method_missing</span><span class="params">(sym, *args)</span></span></div><div class="line">     <span class="string">"<span class="subst">#&#123;sym&#125;</span> not defined on <span class="subst">#&#123;<span class="keyword">self</span>&#125;</span>"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"> </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span></span></div><div class="line">    <span class="string">"My name is Person"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"> </div><div class="line">p = Person.new</div><div class="line"> </div><div class="line">puts p.name     <span class="comment"># =&gt; My name is Person</span></div><div class="line">puts p.address  <span class="comment"># =&gt; address not defined on #&lt;Person:0x007fb2bb022fe0&gt;</span></div></pre></td></tr></table></figure>
<p><code>method_missing</code> 接收两个参数：被调用的方法名和传递给该方法的参数。<br>首先Ruby会寻找我们试图调用的方法，如果方法没找到则会寻找 <code>method_missing</code> 方法。<br>现在我们重载了 <code>Person</code> 中的 <code>method_missing</code>，因此Ruby将会调用它而不是抛出异常。</p>
<p>让我们来看看 <code>Rake</code> 是如何使用 <code>method_missing</code> 的。</p>
<h3 id="Rake中的-method-missing"><a href="#Rake中的-method-missing" class="headerlink" title="Rake中的 method_missing"></a>Rake中的 <code>method_missing</code></h3><p><code>Rake</code> 是Ruby中使用最广泛的gem包之一。<code>Rake</code> 使用 <code>method_missing</code> 来提供访问传递给Rake任务的参数。<br>首先创建一个简单的rake任务：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">task <span class="symbol">:hello</span> <span class="keyword">do</span></div><div class="line">  puts <span class="string">"Hello"</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>如果你通过调用 <code>rake hello</code> 来执行这个任务，你会看到输出 <code>Hello</code>。<br>让我们扩展这个rake任务，以便接收一个参数（一个人名）并向他打招呼：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">task <span class="symbol">:hello</span>, <span class="symbol">:name</span> <span class="keyword">do</span> <span class="params">|t, args|</span></div><div class="line">  puts <span class="string">"Hello <span class="subst">#&#123;args.name&#125;</span>"</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p><code>t</code> 是任务名，<code>args</code> 保存了传递过来的参数。正如你所见，我们调用 <code>args.name</code> 来获取传递给 <code>hello</code> 任务的 <code>name</code> 参数。<br>运行该任务，并传递一个参数：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rake hello[<span class="string">"Imran Latif"</span>]</div><div class="line">=&gt; Hello Imran Latif</div></pre></td></tr></table></figure>
<p>让我们来看看 <code>Rake</code> 是如何使用 <code>method_missing</code> 为我们提供了传递给任务的参数的。</p>
<p>在上面任务中的 <code>args</code> 对象是一个 <code>Rake::TaskArguments</code> 实例，它是在<a href="https://github.com/ruby/rake/blob/v10.4.2/lib/rake/task_arguments.rb" target="_blank" rel="external">这里</a>所定义。<br>这个类负责管理传递给Rake任务的参数。查看 <code>Rake::TaskArguments</code> 的代码，你会发现并没有定义相关的方法将参数传给任务。<br>那么 <code>Rake</code> 是如何将参数提供给任务的呢？答案是 <code>Rake</code> 是使用了 <code>method_missing</code> 巧妙地实现了这个功能。<br>看看第64行 <code>method_missing</code> 的定义：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">method_missing</span><span class="params">(sym, *args)</span></span></div><div class="line">  lookup(sym.to_sym)</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>在这个类中定义 <code>method_missing</code> 是为了保证能够访问到那些未定义的方法，而不是由Ruby抛出异常。<br>在 <code>method_missing</code> 中它调用了 <code>lookup</code> 方法：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">lookup</span><span class="params">(name)</span></span></div><div class="line">  <span class="keyword">if</span> @hash.has_key?(name)</div><div class="line">   @hash[name]</div><div class="line">  <span class="keyword">elsif</span> @parent</div><div class="line">    @parent.lookup(name)</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p><code>method_missing</code> 调用 <code>lookup</code>，并将方法名以 <code>Symbol(符号)</code> 的形式传递给它。<br><code>lookup</code> 方法将会在 <code>@hash</code> 中进行查找，它是在 <code>Rake::TaskArguments</code> 的构造函数中创建的。<br>如果 <code>@hash</code> 中包含该参数则返回，如果在 <code>@hash</code> 中没有则 <code>Rake</code> 会尝试调用 <code>@parent</code> 的 <code>lookup</code>。<br>如果该参数没有找到，则什么都不返回。</p>
<p>这就是 <code>Rake</code> 如何巧妙地使用 <code>method_missing</code> 提供了访问传递给Rake任务的参数的。<br>感谢<a href="https://twitter.com/jimweirich" target="_blank" rel="external">Jim Weirich</a>编写了Rake。</p>
<h1 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h1><p>我们讨论了5个重要的Ruby钩子方法，探索了它们是如何工作的，以及一些流行的框架/gem包是如何使用它们来提供一些优雅的功能。<br>我希望你能喜欢这篇文章。请在评论中告诉我们你所喜欢的Ruby钩子，以及你使用它们所解决的问题。</p>
<p>原文地址： <a href="http://www.sitepoint.com/rubys-important-hook-methods/" target="_blank" rel="external">http://www.sitepoint.com/rubys-important-hook-methods/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.xefan.com/archives/84143.html" data-id="cjoslv00e00omsh083plx4jau" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/2/">&laquo;Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/30/">30</a><a class="extend next" rel="next" href="/page/4/">Next&raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux栏目/">Linux栏目</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python栏目/">Python栏目</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby栏目/">Ruby栏目</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby栏目/Web开发/">Web开发</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web开发/">Web开发</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Web开发/Python栏目/">Python栏目</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端相关/">前端相关</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/嵌入式栏目/">嵌入式栏目</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/开源软件/">开源软件</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/教程/">教程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构和算法/">数据结构和算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程开发/">编程开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络日志/">网络日志</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/资源分享/">资源分享</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ARM/">ARM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Arch/">Arch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/">Django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dreamweaver/">Dreamweaver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fedora/">Fedora</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flash/">Flash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GObject/">GObject</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gentoo/">Gentoo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hash/">Hash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PS/">PS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Qt/">Qt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Raspberry-pi/">Raspberry pi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scrapy/">Scrapy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TQ2440/">TQ2440</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/USB/">USB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VirtualBox/">VirtualBox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web开发/">Web开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WordPress/">WordPress</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Xcode/">Xcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/access/">access</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/adobe/">adobe</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ajax/">ajax</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apache/">apache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asp/">asp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firefox/">firefox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ftp/">ftp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gcc/">gcc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grub/">grub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gtk/">gtk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gulp/">gulp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ibus/">ibus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pygame/">pygame</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vmware/">vmware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/w3m/">w3m</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xml/">xml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/免费/">免费</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内核/">内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/匹配算法/">匹配算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/单片机/">单片机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/嵌入式/">嵌入式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源软件/">开源软件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/排序算法/">排序算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文件空间/">文件空间</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/无线网/">无线网</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/正则式/">正则式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/注册机/">注册机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/游戏/">游戏</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/电脑技巧/">电脑技巧</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/空间/">空间</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/红旗/">红旗</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/经典语录/">经典语录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络日志/">网络日志</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/翻译/">翻译</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/视频教程/">视频教程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/资源分享/">资源分享</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/转载/">转载</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随笔/">随笔</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ARM/" style="font-size: 13.89px;">ARM</a> <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/Arch/" style="font-size: 13.33px;">Arch</a> <a href="/tags/C/" style="font-size: 16.11px;">C</a> <a href="/tags/Django/" style="font-size: 11.11px;">Django</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Dreamweaver/" style="font-size: 10px;">Dreamweaver</a> <a href="/tags/Fedora/" style="font-size: 10.56px;">Fedora</a> <a href="/tags/Flash/" style="font-size: 10px;">Flash</a> <a href="/tags/GObject/" style="font-size: 12.78px;">GObject</a> <a href="/tags/Gentoo/" style="font-size: 10.56px;">Gentoo</a> <a href="/tags/Hash/" style="font-size: 10px;">Hash</a> <a href="/tags/Linux/" style="font-size: 20px;">Linux</a> <a href="/tags/Mac/" style="font-size: 10px;">Mac</a> <a href="/tags/PS/" style="font-size: 12.78px;">PS</a> <a href="/tags/Qt/" style="font-size: 10.56px;">Qt</a> <a href="/tags/Raspberry-pi/" style="font-size: 10px;">Raspberry pi</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/Ruby/" style="font-size: 18.89px;">Ruby</a> <a href="/tags/Scrapy/" style="font-size: 11.11px;">Scrapy</a> <a href="/tags/TQ2440/" style="font-size: 12.22px;">TQ2440</a> <a href="/tags/USB/" style="font-size: 11.11px;">USB</a> <a href="/tags/VirtualBox/" style="font-size: 11.11px;">VirtualBox</a> <a href="/tags/Web开发/" style="font-size: 16.67px;">Web开发</a> <a href="/tags/WordPress/" style="font-size: 10px;">WordPress</a> <a href="/tags/Xcode/" style="font-size: 10px;">Xcode</a> <a href="/tags/access/" style="font-size: 12.78px;">access</a> <a href="/tags/adobe/" style="font-size: 10px;">adobe</a> <a href="/tags/ajax/" style="font-size: 11.11px;">ajax</a> <a href="/tags/angular/" style="font-size: 13.33px;">angular</a> <a href="/tags/apache/" style="font-size: 10px;">apache</a> <a href="/tags/asp/" style="font-size: 13.33px;">asp</a> <a href="/tags/css/" style="font-size: 10.56px;">css</a> <a href="/tags/firefox/" style="font-size: 11.11px;">firefox</a> <a href="/tags/ftp/" style="font-size: 10px;">ftp</a> <a href="/tags/gcc/" style="font-size: 12.78px;">gcc</a> <a href="/tags/git/" style="font-size: 11.67px;">git</a> <a href="/tags/grub/" style="font-size: 10px;">grub</a> <a href="/tags/gtk/" style="font-size: 17.78px;">gtk</a> <a href="/tags/gulp/" style="font-size: 10px;">gulp</a> <a href="/tags/ibus/" style="font-size: 10px;">ibus</a> <a href="/tags/js/" style="font-size: 15.56px;">js</a> <a href="/tags/mongodb/" style="font-size: 15.56px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 11.67px;">mysql</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/php/" style="font-size: 15px;">php</a> <a href="/tags/pygame/" style="font-size: 15.56px;">pygame</a> <a href="/tags/python/" style="font-size: 19.44px;">python</a> <a href="/tags/react/" style="font-size: 12.22px;">react</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/ubuntu/" style="font-size: 13.33px;">ubuntu</a> <a href="/tags/vim/" style="font-size: 18.33px;">vim</a> <a href="/tags/vmware/" style="font-size: 10px;">vmware</a> <a href="/tags/w3m/" style="font-size: 10px;">w3m</a> <a href="/tags/windows/" style="font-size: 13.33px;">windows</a> <a href="/tags/xml/" style="font-size: 10px;">xml</a> <a href="/tags/免费/" style="font-size: 10px;">免费</a> <a href="/tags/内核/" style="font-size: 10px;">内核</a> <a href="/tags/匹配算法/" style="font-size: 12.78px;">匹配算法</a> <a href="/tags/单片机/" style="font-size: 10.56px;">单片机</a> <a href="/tags/嵌入式/" style="font-size: 10px;">嵌入式</a> <a href="/tags/开源软件/" style="font-size: 14.44px;">开源软件</a> <a href="/tags/排序算法/" style="font-size: 14.44px;">排序算法</a> <a href="/tags/文件空间/" style="font-size: 10px;">文件空间</a> <a href="/tags/无线网/" style="font-size: 10px;">无线网</a> <a href="/tags/正则式/" style="font-size: 10px;">正则式</a> <a href="/tags/注册机/" style="font-size: 10.56px;">注册机</a> <a href="/tags/游戏/" style="font-size: 15px;">游戏</a> <a href="/tags/电脑技巧/" style="font-size: 14.44px;">电脑技巧</a> <a href="/tags/空间/" style="font-size: 10px;">空间</a> <a href="/tags/算法/" style="font-size: 17.22px;">算法</a> <a href="/tags/红旗/" style="font-size: 10px;">红旗</a> <a href="/tags/经典语录/" style="font-size: 10px;">经典语录</a> <a href="/tags/网络日志/" style="font-size: 13.33px;">网络日志</a> <a href="/tags/翻译/" style="font-size: 18.33px;">翻译</a> <a href="/tags/视频教程/" style="font-size: 15px;">视频教程</a> <a href="/tags/资源分享/" style="font-size: 15.56px;">资源分享</a> <a href="/tags/转载/" style="font-size: 10.56px;">转载</a> <a href="/tags/随笔/" style="font-size: 10px;">随笔</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">March 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">January 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">November 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">August 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">May 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/09/">September 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">May 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">March 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">December 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">November 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">September 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/08/">August 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/07/">July 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/03/">March 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/02/">February 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/01/">January 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/12/">December 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">November 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/10/">October 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/08/">August 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/07/">July 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/06/">June 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/05/">May 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">April 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/12/">December 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/11/">November 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/10/">October 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/09/">September 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/08/">August 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/07/">July 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/05/">May 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/12/">December 2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/07/">July 2008</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/archives/84172.html">在storybook中使用antd</a>
          </li>
        
          <li>
            <a href="/archives/84171.html">使用python编写游戏修改器</a>
          </li>
        
          <li>
            <a href="/archives/84170.html">使用pytest测试flask应用</a>
          </li>
        
          <li>
            <a href="/archives/84169.html">HAProxy+Nginx+gunicorn获取真实ip</a>
          </li>
        
          <li>
            <a href="/archives/84168.html">在Docker中运行X11程序</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
  <h3 class="widget-title">Link</h3>
    <div class="widget">
      <ul id="category-list">
        <li><a target="_blank" title="我的Github" href="https://github.com/wusuopu">@Github</a></li>
        <li><a target="_blank" title="我的微博" href="http://www.weibo.com/u/1768691343">@Weibo</a></li>
        <li><a target="_blank" title="我的Twitter" href="https://twitter.com/longchangjin">@Twitter</a></li>
        <li><a target="_blank" title="我的豆瓣" href="http://www.douban.com/people/lchj/">@Douban</a></li>

        <li><a target="_blank" title="" href="http://pythoner.net/">python开发者社区</a></li>
        <li><a target="_blank" title="" href="http://simple-is-better.com/">python.cn(news, jobs)</a></li>
        <li><a target="_blank" title="" href="http://gtk.awaysoft.com/">GTK+ 中文社区</a></li>
        <li><a target="_blank" title="小智LOGO - LOGO在线制作神器 - 3分钟完成公司LOGO设计" href="http://xzlogo.com/">小智LOGO</a></li>
      </ul>
    </div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 龍昌<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
<div style="display:none;"><script src="http://s94.cnzz.com/stat.php?id=1259846&web_id=1259846&show=pic" language="JavaScript"></script></div>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
    <a href="/gbook" class="mobile-nav-link">留言板</a>
  
</nav>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>