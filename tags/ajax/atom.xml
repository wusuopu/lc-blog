<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: Ajax | 龍昌博客]]></title>
  <link href="http://www.xefan.com/tags/ajax/atom.xml" rel="self"/>
  <link href="http://www.xefan.com/"/>
  <updated>2016-03-26T11:27:45+08:00</updated>
  <id>http://www.xefan.com/</id>
  <author>
    <name><![CDATA[龍昌]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[HTTP Access Control跨域请求]]></title>
    <link href="http://www.xefan.com/archives/84159.html"/>
    <updated>2016-03-17T16:35:12+08:00</updated>
    <id>http://www.xefan.com/archives/84159-HTTP Access Control跨域请求</id>
    <content type="html"><![CDATA[<p>最近在使用 Ajax api 请求时遇到了跨域的问题，现在问题解决了顺便做个笔记。</p>

<p>场景：现在主站域名为 example.org ，需要通过 ajax 请求 hello-world.example 上的资源。</p>

<h2>Access-Control-Allow-Origin</h2>

<p>如果请求时遇到如下错误：<br/>
<code>No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://example.org' is therefore not allowed access.</code></p>

<p>则需要在 hello-world.example 的 server 端 Response Headers 中设置 <code>Access-Control-Allow-Origin</code> 字段。其值根据情况设置为 <code>http://example.org</code> 或者 <code>https://example.org</code> 。</p>

<h2>Access-Control-Allow-Methods</h2>

<p>一般情况下只允许 GET 和 POST 请求，对于 RESTful 的 api 可能会有其他类型的请求。例如：</p>

<pre><code>$.ajax({
  url: 'http://hello-world.example/sessions/me.json',
  method: 'DELETE',
  dataType: 'json'
});
</code></pre>

<p>这时如果出现方法不被允许，则需要在 server 端 Response Headers 中设置 <code>Access-Control-Allow-Methods</code> 字段。如： <code>Access-Control-Allow-Methods: GET, POST, DELETE</code> 。</p>

<h2>Access-Control-Allow-Credentials</h2>

<p>当在 hello-world.example 站点登录之后，浏览器会保存对应的 Cookies ，但是在 example.org 站点中使用 ajax 时发现 hello-world.example 的 Cookies 并没有附加到 Request Headers 中。</p>

<p>此时就需要设置 XMLHttpRequest 的 <code>withCredentials</code> 属性，例如：</p>

<pre><code>$.ajax({
  url: 'http://hello-world.example/session/me.json',
  method: 'GET',
  dataType: 'json',
  xhrFields: {
      withCredentials: true
  }
});
</code></pre>

<p>同时在 server 端 Response Headers 中设置 <code>Access-Control-Allow-Credentials</code> 字段。说明允许通过跨域修改 Cookies 。如： <code>Access-Control-Allow-Credentials: true</code></p>

<p>以上是常用的几个字段，更多设置参考手册： <a href="https://www.w3.org/TR/access-control/">https://www.w3.org/TR/access-control/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHP GET方法ajax实例]]></title>
    <link href="http://www.xefan.com/archives/83556.html"/>
    <updated>2011-07-24T00:00:00+08:00</updated>
    <id>http://www.xefan.com/archives/83556-PHP GET方法ajax实例</id>
    <content type="html"><![CDATA[<p>首先新建两个文件，文件名分别为：mail.html、mail.php，放在同一目录下。</p>

<p><strong>mail.html</strong>文件内容如下：</p>

<p><font color="#804040">&nbsp;1 </font><font color="#008080">&lt;</font><font color="#804040"><b>html</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;2 </font><font color="#008080">&lt;</font><font color="#804040"><b>head</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;3 </font><font color="#008080">&lt;</font><font color="#804040"><b>meta</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>http-equiv</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;content-type&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>content</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;text/html;charset=utf-8&quot;</font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;4 </font><font color="#008080">&lt;/</font><font color="#804040"><b>head</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;5 </font><font color="#008080">&lt;</font><font color="#804040"><b>body</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;6 </font><font color="#008080">&lt;</font><font color="#804040"><b>form</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>action</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>method</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;post&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>name</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;form1&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>id</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;form1&quot;</font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;7 </font><font color="#008080">&lt;</font><font color="#804040"><b>table</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>border</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;1&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>width</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;100%&quot;</font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;8 </font><font color="#008080">&lt;</font><font color="#804040"><b>tr</b></font><font color="#008080">&gt;&lt;</font><font color="#804040"><b>td</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>height</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;30&quot;</font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;9 </font>请选择：<br>
<font color="#804040">10 </font><font color="#008080">&lt;</font><font color="#804040"><b>select</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>name</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;Card_Choice&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>id</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;Card_Choice&quot;</font><font color="#008080">&nbsp;</font><font color="#6a5acd">onChange=&quot;</font><font color="#6a5acd">valideMail</font>(<font color="#008080">this</font>)<font color="#6a5acd">&quot;</font><font color="#008080">&gt;</font><br>
<font color="#804040">11 </font><br>
<font color="#804040">12 </font><font color="#008080">&lt;</font><font color="#804040"><b>option</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>id</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;s1&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>value</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;无&quot;</font><font color="#008080">&gt;</font>无<font color="#008080">&lt;/</font><font color="#804040"><b>option</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">13 </font><br>
<font color="#804040">14 </font><font color="#008080">&lt;</font><font color="#804040"><b>option</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>id</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;s2&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>value</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;123&quot;</font><font color="#008080">&gt;</font>123<font color="#008080">&lt;/</font><font color="#804040"><b>option</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">15 </font><br>
<font color="#804040">16 </font><font color="#008080">&lt;</font><font color="#804040"><b>option</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>id</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;s3&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>value</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;abc&quot;</font><font color="#008080">&gt;</font>abc<font color="#008080">&lt;/</font><font color="#804040"><b>option</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">17 </font><br>
<font color="#804040">18 </font><font color="#008080">&lt;</font><font color="#804040"><b>option</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>id</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;s4&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>value</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;34dfd@&quot;</font><font color="#008080">&gt;</font>34dfd@<font color="#008080">&lt;/</font><font color="#804040"><b>option</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">19 </font><br>
<font color="#804040">20 </font><font color="#008080">&lt;/</font><font color="#804040"><b>select</b></font><font color="#008080">&gt;</font><font color="#008080">&lt;</font><font color="#804040"><b>span</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>id</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;show&quot;</font><font color="#008080">&gt;</font><font color="#008080">&lt;/</font><font color="#804040"><b>span</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">21 </font><br>
<font color="#804040">22 </font><font color="#008080">&lt;/</font><font color="#804040"><b>td</b></font><font color="#008080">&gt;&lt;/</font><font color="#804040"><b>tr</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">23 </font><br>
<font color="#804040">24 </font><font color="#008080">&lt;/</font><font color="#804040"><b>table</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">25 </font><br>
<font color="#804040">26 </font><font color="#008080">&lt;/</font><font color="#804040"><b>form</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">27 </font><br>
<font color="#804040">28 </font><font color="#008080">&lt;/</font><font color="#804040"><b>body</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">29 </font><br>
<font color="#804040">30 </font><font color="#008080">&lt;/</font><font color="#804040"><b>html</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">31 </font><br>
<font color="#804040">32 </font><font color="#008080">&lt;</font><font color="#804040"><b>script</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>language</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;javascript&quot;</font><font color="#008080">&gt;</font><br>
<font color="#804040">33 </font><br>
<font color="#804040">34 </font><font color="#008080">var</font><font color="#6a5acd">&nbsp;xmlHttp;</font><br>
<font color="#804040">35 </font><br>
<font color="#804040">36 </font><font color="#008080">function</font><font color="#6a5acd">&nbsp;valideMail</font>(<font color="#6a5acd">obj</font>)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">37 </font><br>
<font color="#804040">38 </font><font color="#0000ff">//var email = document.getElementById(&quot;eMail&quot;);</font><br>
<font color="#804040">39 </font><br>
<font color="#804040">40 </font><font color="#008080">var</font><font color="#6a5acd">&nbsp;url = </font><font color="#ff00ff">&quot;mail.php?email=&quot;</font><font color="#6a5acd">&nbsp;+ obj.value;</font><br>
<font color="#804040">41 </font><br>
<font color="#804040">42 </font><font color="#804040"><b>if</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#804040"><b>window</b></font><font color="#6a5acd">.ActiveXObject</font>)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">43 </font><br>
<font color="#804040">44 </font><font color="#6a5acd">xmlHttp = </font><font color="#804040"><b>new</b></font><font color="#6a5acd">&nbsp;ActiveXObject</font>(<font color="#ff00ff">&quot;Microsoft.XMLHTTP&quot;</font>)<font color="#6a5acd">;</font><br>
<font color="#804040">45 </font><br>
<font color="#804040">46 </font><font color="#008080">}</font><font color="#6a5acd">&nbsp;</font><font color="#804040"><b>else</b></font><font color="#6a5acd">&nbsp;</font><font color="#804040"><b>if</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#804040"><b>window</b></font><font color="#6a5acd">.XMLHttpRequest</font>)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">47 </font><br>
<font color="#804040">48 </font><font color="#6a5acd">xmlHttp = </font><font color="#804040"><b>new</b></font><font color="#6a5acd">&nbsp;XMLHttpRequest</font>()<font color="#6a5acd">;</font><br>
<font color="#804040">49 </font><br>
<font color="#804040">50 </font><font color="#008080">}</font><br>
<font color="#804040">51 </font><br>
<font color="#804040">52 </font><font color="#6a5acd">xmlHttp.onreadystatechange = callBack;</font><br>
<font color="#804040">53 </font><br>
<font color="#804040">54 </font><font color="#6a5acd">xmlHttp.open</font>(<font color="#ff00ff">&lsquo;GET&rsquo;</font><font color="#6a5acd">, url, </font><font color="#ff00ff">true</font>)<font color="#6a5acd">;</font><br>
<font color="#804040">55 </font><br>
<font color="#804040">56 </font><font color="#6a5acd">xmlHttp.send</font>(<font color="#804040"><b>null</b></font>)<font color="#6a5acd">;</font><br>
<font color="#804040">57 </font><br>
<font color="#804040">58 </font><font color="#008080">}</font><br>
<font color="#804040">59 </font><br>
<font color="#804040">60 </font><font color="#008080">function</font><font color="#6a5acd">&nbsp;callBack</font>()<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">61 </font><br>
<font color="#804040">62 </font><font color="#804040"><b>if</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#6a5acd">xmlHttp.readyState == </font>4)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">63 </font><br>
<font color="#804040">64 </font><font color="#804040"><b>if</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#6a5acd">xmlHttp.</font><font color="#804040"><b>status</b></font><font color="#6a5acd">&nbsp;== </font>200)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">65 </font><br>
<font color="#804040">66 </font><font color="#804040"><b>document</b></font><font color="#6a5acd">.getElementById</font>(<font color="#ff00ff">&quot;show&quot;</font>)<font color="#6a5acd">.innerHTML = </font><font color="#ff00ff">&quot;show:&quot;</font><font color="#6a5acd">&nbsp;+ xmlHttp.responseText;</font><br>
<font color="#804040">67 </font><br>
<font color="#804040">68 </font><font color="#008080">}</font><br>
<font color="#804040">69 </font><br>
<font color="#804040">70 </font><font color="#008080">}</font><br>
<font color="#804040">71 </font><br>
<font color="#804040">72 </font><font color="#008080">}</font><br>
<font color="#804040">73 </font><br>
<font color="#804040">74 </font><font color="#008080">&lt;/</font><font color="#804040"><b>script</b></font><font color="#008080">&gt;</font><br></p>

<p><strong>mail.php</strong>文件内容如下：</p>

<p><font color="#804040">&nbsp;1 </font><font color="#6a5acd">&lt;?php</font><br>
<font color="#804040">&nbsp;2 </font><br>
<font color="#804040">&nbsp;3 </font><font color="#804040"><b>$</b></font><font color="#008080">email</font>&nbsp;<font color="#804040"><b>=</b></font>&nbsp;<font color="#804040"><b>$</b></font><font color="#008080">_GET</font><font color="#6a5acd">[</font>&quot;<font color="#ff00ff">email</font>&quot;<font color="#6a5acd">]</font>;<br>
<font color="#804040">&nbsp;4 </font><br>
<font color="#804040">&nbsp;5 </font><font color="#804040"><b>if</b></font>&nbsp;<font color="#6a5acd">(</font><font color="#804040"><b>$</b></font><font color="#008080">email</font>&nbsp;<font color="#804040"><b>==</b></font>&nbsp;&quot;&quot;<font color="#6a5acd">)</font>&nbsp;<font color="#6a5acd">{</font><br>
<font color="#804040">&nbsp;6 </font><br>
<font color="#804040">&nbsp;7 </font><font color="#804040"><b>$</b></font><font color="#008080">email</font>&nbsp;<font color="#804040"><b>=</b></font>&nbsp;&quot;<font color="#ff00ff">rrrrrrrrrrrrrrrrrr !</font>&quot;;<br>
<font color="#804040">&nbsp;8 </font><br>
<font color="#804040">&nbsp;9 </font><font color="#6a5acd">}</font><br>
<font color="#804040">10 </font><br>
<font color="#804040">11 </font><font color="#a020f0">echo</font>&nbsp;<font color="#6a5acd">(</font><font color="#804040"><b>$</b></font><font color="#008080">email</font><font color="#6a5acd">)</font>;<br>
<font color="#804040">12 </font><br>
<font color="#804040">13 </font><font color="#804040"><b>exit</b></font><font color="#6a5acd">(</font><font color="#ff00ff">0</font><font color="#6a5acd">)</font>;<br>
<font color="#804040">14 </font><br>
<font color="#804040">15 </font><font color="#6a5acd">?&gt;</font><br></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHP POST方法ajax实例]]></title>
    <link href="http://www.xefan.com/archives/83550.html"/>
    <updated>2011-07-24T00:00:00+08:00</updated>
    <id>http://www.xefan.com/archives/83550-PHP POST方法ajax实例</id>
    <content type="html"><![CDATA[<p>首先新建两个文件，文件名分别为：ajax_post.html、ajax_output_post.php，放在同一目录下。</p>

<p><strong>ajax_post.html</strong>内容如下：</p>

<p><font color="#804040">&nbsp;1 </font><font color="#008080">&lt;</font><font color="#804040"><b>head</b></font><font color="#008080">&gt;</font><font color="#a020f0">&nbsp;</font><font color="#008080">&lt;</font><font color="#804040"><b>meta</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>http-equiv</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;Content-Type&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>content</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;text/html; charset=utf-8&quot;</font><font color="#008080">&nbsp;/&gt;</font><font color="#a020f0">&nbsp;</font><font color="#008080">&lt;</font><font color="#804040"><b>title</b></font><font color="#008080">&gt;</font><font color="#ff00ff"><b>Untitled Document</b></font><font color="#008080">&lt;/</font><font color="#804040"><b>title</b></font><font color="#008080">&gt;</font><font color="#a020f0">&nbsp;</font><font color="#008080">&lt;/</font><font color="#804040"><b>head</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;2 </font><br>
<font color="#804040">&nbsp;3 </font><font color="#008080">&lt;</font><font color="#804040"><b>script</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>language</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;javascript&quot;</font><font color="#008080">&gt;</font><br>
<font color="#804040">&nbsp;4 </font><br>
<font color="#804040">&nbsp;5 </font><font color="#008080">function</font><font color="#6a5acd">&nbsp;saveUserInfo</font>()<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">&nbsp;6 </font><br>
<font color="#804040">&nbsp;7 </font><font color="#0000ff">//获取接受返回信息层</font><br>
<font color="#804040">&nbsp;8 </font><br>
<font color="#804040">&nbsp;9 </font><font color="#008080">var</font><font color="#6a5acd">&nbsp;msg = </font><font color="#804040"><b>document</b></font><font color="#6a5acd">.getElementById</font>(<font color="#ff00ff">&quot;msg&quot;</font>)<font color="#6a5acd">;</font><br>
<font color="#804040">10 </font><br>
<font color="#804040">11 </font><font color="#0000ff">//获取表单对象和用户信息值</font><br>
<font color="#804040">12 </font><br>
<font color="#804040">13 </font><font color="#008080">var</font><font color="#6a5acd">&nbsp;f = </font><font color="#804040"><b>document</b></font><font color="#6a5acd">.user_info; </font><font color="#008080">var</font><font color="#6a5acd">&nbsp;userName = f.user_name.value; </font><font color="#008080">var</font><font color="#6a5acd">&nbsp;userAge = f.user_age.value; </font><font color="#008080">var</font><font color="#6a5acd">&nbsp;userSex = f.user_sex.value;</font><br>
<font color="#804040">14 </font><br>
<font color="#804040">15 </font><font color="#0000ff">//接收表单的URL地址</font><br>
<font color="#804040">16 </font><br>
<font color="#804040">17 </font><font color="#008080">var</font><font color="#6a5acd">&nbsp;url = </font><font color="#ff00ff">&quot;ajax_output_post.php&quot;</font><font color="#6a5acd">;</font><br>
<font color="#804040">18 </font><br>
<font color="#804040">19 </font><font color="#0000ff">//需要POST的值，把每个变量都通过&amp;来联接</font><br>
<font color="#804040">20 </font><br>
<font color="#804040">21 </font><font color="#008080">var</font><font color="#6a5acd">&nbsp;postStr = </font><font color="#ff00ff">&quot;user_name=&quot;</font><font color="#6a5acd">+ userName +</font><font color="#ff00ff">&quot;&amp;user_age=&quot;</font><font color="#6a5acd">+ userAge +</font><font color="#ff00ff">&quot;&amp;user_sex=&quot;</font><font color="#6a5acd">+ userSex;</font><br>
<font color="#804040">22 </font><br>
<font color="#804040">23 </font><font color="#0000ff">//实例化Ajax //var ajax = InitAjax();</font><br>
<font color="#804040">24 </font><br>
<font color="#804040">25 </font><font color="#0000ff">// var ajax = false;</font><br>
<font color="#804040">26 </font><br>
<font color="#804040">27 </font><font color="#0000ff">//开始初始化XMLHttpRequest对象</font><br>
<font color="#804040">28 </font><br>
<font color="#804040">29 </font><font color="#804040"><b>if</b></font>(<font color="#804040"><b>window</b></font><font color="#6a5acd">.XMLHttpRequest</font>)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">30 </font><br>
<font color="#804040">31 </font><font color="#0000ff">//Mozilla 浏览器</font><br>
<font color="#804040">32 </font><br>
<font color="#804040">33 </font><font color="#6a5acd">ajax = </font><font color="#804040"><b>new</b></font><font color="#6a5acd">&nbsp;XMLHttpRequest</font>()<font color="#6a5acd">;</font><br>
<font color="#804040">34 </font><br>
<font color="#804040">35 </font><font color="#804040"><b>if</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#6a5acd">ajax.overrideMimeType</font>)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">36 </font><br>
<font color="#804040">37 </font><font color="#0000ff">//设置MiME类别</font><br>
<font color="#804040">38 </font><br>
<font color="#804040">39 </font><font color="#6a5acd">ajax.overrideMimeType</font>(<font color="#ff00ff">&quot;text/xml&quot;</font>)<font color="#6a5acd">; </font><font color="#008080">}</font><br>
<font color="#804040">40 </font><br>
<font color="#804040">41 </font><font color="#008080">}</font><font color="#6a5acd">&nbsp;</font><font color="#804040"><b>else</b></font><font color="#6a5acd">&nbsp;</font><font color="#804040"><b>if</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#804040"><b>window</b></font><font color="#6a5acd">.ActiveXObject</font>)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">42 </font><br>
<font color="#804040">43 </font><font color="#0000ff">// IE浏览器</font><br>
<font color="#804040">44 </font><br>
<font color="#804040">45 </font><font color="#804040"><b>try</b></font><font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><font color="#6a5acd">&nbsp;ajax = </font><font color="#804040"><b>new</b></font><font color="#6a5acd">&nbsp;ActiveXObject</font>(<font color="#ff00ff">&quot;Msxml2.XMLHTTP&quot;</font>)<font color="#6a5acd">; </font><font color="#008080">}</font><font color="#6a5acd">&nbsp;</font><font color="#804040"><b>catch</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#6a5acd">e</font>)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><font color="#6a5acd">&nbsp;</font><font color="#804040"><b>try</b></font><font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><font color="#6a5acd">&nbsp;ajax = </font><font color="#804040"><b>new</b></font><font color="#6a5acd">&nbsp;ActiveXObject</font>(<font color="#ff00ff">&quot;Microsoft.XMLHTTP&quot;</font>)<font color="#6a5acd">; </font><font color="#008080">}</font><font color="#6a5acd">&nbsp;</font><font color="#804040"><b>catch</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#6a5acd">e</font>)<font color="#6a5acd">&nbsp;</font><font color="#008080">{}</font><font color="#6a5acd">&nbsp;</font><font color="#008080">}</font><font color="#6a5acd">&nbsp;</font><font color="#008080">}</font><font color="#6a5acd">&nbsp;</font><font color="#804040"><b>if</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#6a5acd">!ajax</font>)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">46 </font><br>
<font color="#804040">47 </font><font color="#0000ff">// 异常，创建对象实例失败</font><br>
<font color="#804040">48 </font><br>
<font color="#804040">49 </font><font color="#804040"><b>window</b></font><font color="#6a5acd">.</font><font color="#804040"><b>alert</b></font>(<font color="#ff00ff">&quot;不能创建XMLHttpRequest对象实例.&quot;</font>)<font color="#6a5acd">; </font><font color="#804040"><b>return</b></font><font color="#6a5acd">&nbsp;</font><font color="#ff00ff">false</font><font color="#6a5acd">; </font><font color="#008080">}</font><br>
<font color="#804040">50 </font><br>
<font color="#804040">51 </font><font color="#0000ff">//通过Post方式打开连接</font><br>
<font color="#804040">52 </font><br>
<font color="#804040">53 </font><font color="#6a5acd">ajax.open</font>(<font color="#ff00ff">&quot;POST&quot;</font><font color="#6a5acd">, url, </font><font color="#ff00ff">true</font>)<font color="#6a5acd">;</font><br>
<font color="#804040">54 </font><br>
<font color="#804040">55 </font><font color="#0000ff">//定义传输的文件HTTP头信息</font><br>
<font color="#804040">56 </font><br>
<font color="#804040">57 </font><font color="#6a5acd">ajax.setRequestHeader</font>(<font color="#ff00ff">&quot;Content-Type&quot;</font><font color="#6a5acd">,</font><font color="#ff00ff">&quot;application/x-www-form-urlencoded&quot;</font>)<font color="#6a5acd">;</font><br>
<font color="#804040">58 </font><br>
<font color="#804040">59 </font><font color="#0000ff">//发送POST数据</font><br>
<font color="#804040">60 </font><br>
<font color="#804040">61 </font><font color="#6a5acd">ajax.send</font>(<font color="#6a5acd">postStr</font>)<font color="#6a5acd">;</font><br>
<font color="#804040">62 </font><br>
<font color="#804040">63 </font><font color="#0000ff">//获取执行状态</font><br>
<font color="#804040">64 </font><br>
<font color="#804040">65 </font><font color="#6a5acd">ajax.onreadystatechange = </font><font color="#008080">function</font>()<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><br>
<font color="#804040">66 </font><br>
<font color="#804040">67 </font><font color="#0000ff">//如果执行状态成功，那么就把返回信息写到指定的层里</font><br>
<font color="#804040">68 </font><br>
<font color="#804040">69 </font><font color="#804040"><b>if</b></font><font color="#6a5acd">&nbsp;</font>(<font color="#6a5acd">ajax.readyState == </font>4<font color="#6a5acd">&nbsp;&amp;&amp; ajax.</font><font color="#804040"><b>status</b></font><font color="#6a5acd">&nbsp;== </font>200)<font color="#6a5acd">&nbsp;</font><font color="#008080">{</font><font color="#6a5acd">&nbsp;msg.innerHTML = ajax.responseText; </font><font color="#008080">}</font><font color="#6a5acd">&nbsp;</font><font color="#008080">}</font><br>
<font color="#804040">70 </font><br>
<font color="#804040">71 </font><font color="#008080">}</font><br>
<font color="#804040">72 </font><br>
<font color="#804040">73 </font><font color="#008080">&lt;/</font><font color="#804040"><b>script</b></font><font color="#008080">&gt;</font><br>
<font color="#804040">74 </font><br>
<font color="#804040">75 </font><font color="#008080">&lt;</font><font color="#804040"><b>body</b></font><font color="#008080">&nbsp;&gt;</font>&nbsp;?<font color="#008080">&lt;</font><font color="#804040"><b>form</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>name</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;user_info&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>method</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;post&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>action</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;&quot;</font><font color="#008080">&gt;</font>&nbsp;姓名：<font color="#008080">&lt;</font><font color="#804040"><b>input</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>type</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;text&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>name</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;user_name&quot;</font><font color="#008080">&nbsp;/&gt;&lt;</font><font color="#804040"><b>br</b></font><font color="#008080">&nbsp;/&gt;</font>&nbsp;年龄：<font color="#008080">&lt;</font><font color="#804040"><b>input</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>type</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;text&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>name</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;user_age&quot;</font><font color="#008080">&nbsp;/&gt;&lt;</font><font color="#804040"><b>br</b></font><font color="#008080">&nbsp;/&gt;</font>&nbsp;性别：<font color="#008080">&lt;</font><font color="#804040"><b>input</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>type</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;text&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>name</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;user_sex&quot;</font><font color="#008080">&nbsp;/&gt;&lt;</font><font color="#804040"><b>br</b></font><font color="#008080">&nbsp;/&gt;</font><br>
<font color="#804040">76 </font><br>
<font color="#804040">77 </font><font color="#008080">&lt;</font><font color="#804040"><b>input</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>type</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;button&quot;</font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>value</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;提交表单&quot;</font><font color="#008080">&nbsp;</font><font color="#6a5acd">onClick=&quot;</font><font color="#6a5acd">saveUserInfo</font>()<font color="#6a5acd">&quot;</font><font color="#008080">&gt;</font>&nbsp;<font color="#008080">&lt;/</font><font color="#804040"><b>form</b></font><font color="#008080">&gt;</font><font color="#008080">&lt;</font><font color="#804040"><b>div</b></font><font color="#008080">&nbsp;</font><font color="#2e8b57"><b>id</b></font><font color="#008080">=</font><font color="#ff00ff">&quot;msg&quot;</font><font color="#008080">&gt;</font>&nbsp;<font color="#008080">&lt;/</font><font color="#804040"><b>div</b></font><font color="#008080">&gt;</font>&nbsp;<font color="#008080">&lt;/</font><font color="#804040"><b>body</b></font><font color="#008080">&gt;</font><br></p>

<p><strong>ajax_output_post.php</strong>内容如下：</p>

<p><font color="#804040">1 </font><font color="#6a5acd">&lt;?</font><br>
<font color="#804040">2 </font>&nbsp;<br>
<font color="#804040">3 </font><font color="#a020f0">echo</font>&nbsp;&lsquo;<font color="#ff00ff">姓名:</font>&rsquo;<font color="#804040"><b>.</b></font><font color="#804040"><b>$</b></font><font color="#008080"><em>POST</font><font color="#6a5acd">[</font>&lsquo;<font color="#ff00ff">user_name</font>&rsquo;<font color="#6a5acd">]</font><font color="#804040"><b>.</b></font>&lsquo;<font color="#ff00ff">&lt;br&gt;</font>&rsquo;;<br>
<font color="#804040">4 </font>&nbsp;<br>
<font color="#804040">5 </font><font color="#a020f0">echo</font>&nbsp;&lsquo;<font color="#ff00ff">年龄:</font>&rsquo;<font color="#804040"><b>.</b></font><font color="#804040"><b>$</b></font><font color="#008080"></em>POST</font><font color="#6a5acd">[</font>&lsquo;<font color="#ff00ff">user_age</font>&rsquo;<font color="#6a5acd">]</font><font color="#804040"><b>.</b></font>&lsquo;<font color="#ff00ff">&lt;br&gt;</font>&rsquo;;<br>
<font color="#804040">6 </font>&nbsp;<br>
<font color="#804040">7 </font><font color="#a020f0">echo</font>&nbsp;&lsquo;<font color="#ff00ff">性别:</font>&rsquo;<font color="#804040"><b>.</b></font><font color="#804040"><b>$</b></font><font color="#008080">_POST</font><font color="#6a5acd">[</font>&lsquo;<font color="#ff00ff">user_sex</font>&rsquo;<font color="#6a5acd">]</font><font color="#804040"><b>.</b></font>&lsquo;<font color="#ff00ff">&lt;br&gt;</font>&rsquo;;<br>
<font color="#804040">8 </font>&nbsp;<br>
<font color="#804040">9 </font><font color="#6a5acd">?&gt;</font><br></p>
]]></content>
  </entry>
  
</feed>
