<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: Django | 龍昌博客]]></title>
  <link href="http://www.xefan.com/tags/Django/atom.xml" rel="self"/>
  <link href="http://www.xefan.com/"/>
  <updated>2014-11-04T14:51:39+08:00</updated>
  <id>http://www.xefan.com/</id>
  <author>
    <name><![CDATA[龍昌]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Scrapy框架学习笔记2—— Scrapy与Django结合]]></title>
    <link href="http://www.xefan.com/archives/83887.html"/>
    <updated>2013-10-07T00:00:00+08:00</updated>
    <id>http://www.xefan.com/archives/83887-Scrapy框架学习笔记2—— Scrapy与Django结合</id>
    <content type="html"><![CDATA[<p>前面也介绍过了Scrapy与Django的设计思想非常相似，因此这个两个结合也是比较容易的。<br/>
以下方法在Scrapy 0.18与Django 1.5下面测试是可以用的。</p>

<h3>1.首先设置Django的运行环境</h3>


<p>在settings.py中添加如下代码：</p>

<pre><code class="python">def setup_django_environment(path):
    import imp, os, sys
    from django.core.management import setup_environ
    m = imp.load_module('settings', *imp.find_module('settings', [path]))
    setup_environ(m)
    sys.path.append(os.path.abspath(os.path.join(path, os.path.pardir)))

setup_django_environment("/django/project/path")
</code></pre>

<p>注意：如果你的Django项目是用的sqlite数据库的话，那就需要设置为绝对路径，不能使用相对路径。</p>

<h3>2.创建django item</h3>


<p>首先在Django项目代码中创建一个Django的model，例如:</p>

<pre><code class="python">from django.db import models
class ScrapyModel(models.Model):
    title = models.CharField(max_length=200)
    link = models.CharField(max_length=200)
    desc = models.TextField()
</code></pre>

<p>然后在Scrapy项目中创建一个新的Item，只不过这次我们不再是继承自scrapy.item.Item，而是scrapy.contrib.djangoitem.DjangoItem:</p>

<pre><code class="python">class Test1DjItem(DjangoItem):
    django_model = ScrapyModel
</code></pre>

<p>用法与原来的Item相同，只是最后要执行一个save函数来调用django的save方法将数据存入数据库。</p>
]]></content>
  </entry>
  
</feed>
