---
layout: post
title: "通过串口连接raspberry pi"
date: 2016-11-03 05:35:57 +0000
comments: true
post_id: 84166
permalink: /archives/84166.html
categories: ["嵌入式栏目"]
tags: ["Raspberry pi"]
---

最近在玩树莓派，有时没有网络，也没有显示器，此时如果想要连接树莓派执行一些操作的话会很麻烦。
因为之前玩过 ARM 的开发板编程，因此想能不能通过串口登录到 pi 呢。于是网上查了一下，还真的可以哦。
以下就作为备忘笔记记录一下操作过程。

1.首先需要一根 USB 转串口的线，如果没有的话可以去某宝上买一根吧，反正也不贵。我选的是 PL2303。
再根据系统以及芯片的不同而下载安装不同的驱动程序。 对于 mac OS 用户执行命令： `ls /dev/ | grep tty.usb` ，
如果驱动都安装正确的话应该是会有输出结果的。


2.然后在 pi 的系统上启用 serial。我安装的是 debian 系统，执行命令： `sudo raspi-config` ，
选择 `advanced options` -> `serial` 进行启用 serial。

或者在烧录系统时直接配置：
向microSD卡中烧录树莓派官方的镜像后，先不要急着把它插入树莓派中。
在电脑上打开microSD卡，按如下方式修改config.txt和cmdline.txt这两个文件，
在config.txt文件中附加
```
dtoverlay=miniuart-bt
enable_uart=1
```

在cmdline.txt中添加如下的配置
```
dwc_otg.lpm_enable=0 console=tty1 console=serial0,115200
```

不然串口输出可能会乱码。

修改 /boot/firstrun.sh
```
# 启动 vnc 服务
ln -sv /etc/systemd/system/multi-user.target.wants/vncserver-x11-serviced.service /lib/systemd/system/vncserver-x11-serviced.service
systemctl enable vncserver-x11-servicedsystemctl enable vncserver-x11-serviced

# 添加新的 wifi ssid
cat >/etc/wpa_supplicant/wpa_supplicant.conf <<'WPAEOF'
country=CN
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
ap_scan=1

update_config=1
# 通过 wpa_passphrase ssid psk 生成
network={
        ssid="ssid1"
        psk=加密后的密码
        id_str="识别1"
}

network={
        ssid="ssid2"
        psk=加密后的密码
        id_str="识别2"
}

WPAEOF
```


3.串口连接  

对于 Raspberry Pi3 的 GPIO 引脚如下：  
![pi3_gpio](/wp-content/uploads/2016/11/03/pi3_gpio.png)

串口线与 pi 的连接方式为： GND -> GND, RXD -> TXD, TXD -> RXD， 如图：  
![pi3-board](/wp-content/uploads/2016/11/03/pi3-board.jpg)

最后在电脑上使用串口连接软件进行连接，对应的串口设置为 115200 8N1，如图：  
![raspberry-pi-serial](/wp-content/uploads/2016/11/03/raspberry-pi-serial.png)


参考资料： http://elinux.org/RPi_Serial_Connection
